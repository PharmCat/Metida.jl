<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · Metida Documentation</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">Metida Documentation</span></div><form class="docs-search" action="search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a><ul class="internal"><li><a class="tocitem" href="#Mixed-Models"><span>Mixed Models</span></a></li></ul></li><li><a class="tocitem" href="details/">Details</a></li><li><a class="tocitem" href="examples/">Examples</a></li><li><a class="tocitem" href="options/">Options</a></li><li><a class="tocitem" href="nlopt/">NLopt</a></li><li><a class="tocitem" href="cuda/">CUDA</a></li><li><a class="tocitem" href="bench/">Benchmark</a></li><li><a class="tocitem" href="validation/">Validation</a></li><li><a class="tocitem" href="api/">API</a></li><li><a class="tocitem" href="ref/">Citation &amp; Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/PharmCat/Metida.jl/blob/master/docs/src/index.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Metida"><a class="docs-heading-anchor" href="#Metida">Metida</a><a id="Metida-1"></a><a class="docs-heading-anchor-permalink" href="#Metida" title="Permalink"></a></h1><h2 id="Mixed-Models"><a class="docs-heading-anchor" href="#Mixed-Models">Mixed Models</a><a id="Mixed-Models-1"></a><a class="docs-heading-anchor-permalink" href="#Mixed-Models" title="Permalink"></a></h2><p>Multilevel models (also known as hierarchical linear models, linear mixed-effect model, mixed models, nested data models, random coefficient, random-effects models, random parameter models, or split-plot designs) are statistical models of parameters that vary at more than one level. An example could be a model of student performance that contains measures for individual students as well as measures for classrooms within which the students are grouped. These models can be seen as generalizations of linear models (in particular, linear regression), although they can also extend to non-linear models. These models became much more popular after sufficient computing power and software became available. (<a href="https://en.wikipedia.org/wiki/Multilevel_model">Wiki</a>)</p><p>Metida.jl is a Julia package for fitting mixed-effects models with flexible covariance structure.</p><p>Implemented covariance structures:</p><ul><li>Scaled Identity (SI)</li><li>Diagonal (DIAG)</li><li>Autoregressive (AR)</li><li>Heterogeneous Autoregressive (ARH)</li><li>Compound Symmetry (CS)</li><li>Heterogeneous Compound Symmetry (CSH)</li><li>Autoregressive Moving Average (ARMA)</li></ul><h3 id="Usage"><a class="docs-heading-anchor" href="#Usage">Usage</a><a id="Usage-1"></a><a class="docs-heading-anchor-permalink" href="#Usage" title="Permalink"></a></h3><h4 id="Model-construction"><a class="docs-heading-anchor" href="#Model-construction">Model construction</a><a id="Model-construction-1"></a><a class="docs-heading-anchor-permalink" href="#Model-construction" title="Permalink"></a></h4><p><code>LMM(model, data; subject = nothing,  random = nothing, repeated = nothing)</code></p><p>where:</p><ul><li><p><code>model</code> is a fixed-effect model (<code>@formula</code>), example: <code>@formula(var ~ sequence + period + formulation)</code></p></li><li><p><code>random</code> vector of random effects or single random effect. Effects can be specified like this: <code>VarEffect(@covstr(formulation), CSH)</code>. <code>@covstr</code> is a effect model: <code>@covstr(formulation)</code>. <code>CSH</code> is a  CovarianceType structure. Premade constants: SI, DIAG, AR, ARH, CS, CSH, ARMA.</p></li><li><p><code>repeated</code> is a repeated effect (only single).</p></li><li><p><code>subject</code> is a block-diagonal factor.</p></li></ul><h4 id="Fitting"><a class="docs-heading-anchor" href="#Fitting">Fitting</a><a id="Fitting-1"></a><a class="docs-heading-anchor-permalink" href="#Fitting" title="Permalink"></a></h4><pre><code class="language-none">fit!(lmm::LMM{T};
    solver::Symbol = :default,
    verbose = :auto,
    varlinkf = :exp,
    rholinkf = :sigm,
    aifirst::Bool = false,
    g_tol::Float64 = 1e-12,
    x_tol::Float64 = 1e-12,
    f_tol::Float64 = 1e-12,
    hcalck::Bool   = true,
    init = nothing,
    io::IO = stdout)</code></pre><p>where:</p><ul><li><p><code>solver</code> - :default / :nlopt / :cuda</p></li><li><p><code>verbose</code> - :auto / 1 / 2 / 3</p></li><li><p><code>varlinkf</code> - not implemented</p></li><li><p><code>rholinkf</code> - :sigm / :atan</p></li><li><p><code>aifirst</code> - first iteration with AI-like method</p></li><li><p><code>g_tol</code> - absolute tolerance in the gradient</p></li><li><p><code>x_tol</code> - absolute tolerance of theta vector</p></li><li><p><code>f_tol</code> - absolute tolerance in changes of the REML</p></li><li><p><code>hcalck</code> - calculate REML Hessian</p></li><li><p><code>init</code> - initial theta values</p></li><li><p><code>io</code> - uotput IO</p></li></ul><ul><ul><li><a href="api/#API">API</a></li><li><a href="bench/#Benchmark">Benchmark</a></li><li><a href="cuda/#CUDA">CUDA</a></li><li><a href="details/#Details">Details</a></li><li><a href="examples/#Examples">Examples</a></li></ul><li><a href="#Metida">Metida</a></li><ul><li><a href="#Mixed-Models">Mixed Models</a></li><li><a href="nlopt/#NLopt">NLopt</a></li><li><a href="options/#Options">Options</a></li><li><a href="ref/#Citation-and-Reference">Citation &amp; Reference</a></li><li><a href="validation/#Validation">Validation</a></li><li><a href="validation/#Section-1:-REML-validation-for-public-datasets-Metida-vs-SPSS">Section 1: REML validation for public datasets Metida vs SPSS</a></li><li><a href="validation/#Section-2:-Parameters-validation-for-public-datasets-Metida-and-SPSS-and-MixedModels">Section 2: Parameters validation for public datasets Metida &amp; SPSS &amp; MixedModels</a></li><li><a href="validation/#Section-3:-Validation-with-bioequivalence-datasets-with-Metida-and-SPSS">Section 3: Validation with bioequivalence datasets with Metida &amp; SPSS</a></li><li><a href="validation/#Discussion">Discussion</a></li></ul></ul><p>See also:</p><ul><li><p><a href="https://github.com/JuliaStats/MixedModels.jl">MixedModels.jl</a></p></li><li><p><a href="https://github.com/JuliaStats/GLM.jl">GLM.jl</a></p></li><li><p><a href="https://github.com/joshday/SweepOperator.jl">SweepOperator.jl</a></p></li></ul><h3 id="Reference"><a class="docs-heading-anchor" href="#Reference">Reference</a><a id="Reference-1"></a><a class="docs-heading-anchor-permalink" href="#Reference" title="Permalink"></a></h3><ul><li>Gelman, A.; Hill, J. (2007). Data Analysis Using Regression and Multilevel/Hierarchical Models. New York: Cambridge University Press. pp. 235–299. ISBN 978-0-521-68689-1.</li></ul></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="details/">Details »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Friday 5 February 2021 21:11">Friday 5 February 2021</span>. Using Julia version 1.5.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
