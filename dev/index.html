<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · Metida.jl</title><meta name="title" content="Home · Metida.jl"/><meta property="og:title" content="Home · Metida.jl"/><meta property="twitter:title" content="Home · Metida.jl"/><meta name="description" content="Documentation for Metida.jl."/><meta property="og:description" content="Documentation for Metida.jl."/><meta property="twitter:description" content="Documentation for Metida.jl."/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>Metida.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a><ul class="internal"><li><a class="tocitem" href="#Mixed-Models"><span>Mixed Models</span></a></li><li><a class="tocitem" href="#Limitations"><span>Limitations</span></a></li><li><a class="tocitem" href="#Contents"><span>Contents</span></a></li><li><a class="tocitem" href="#Reference"><span>Reference</span></a></li></ul></li><li><span class="tocitem">User guide</span><ul><li><a class="tocitem" href="instanduse/">First step</a></li><li><a class="tocitem" href="examples/">Examples</a></li><li><a class="tocitem" href="custom/">Custom structures</a></li><li><a class="tocitem" href="bioequivalence/">Bioequivalence</a></li><li><a class="tocitem" href="nlopt/">NLopt</a></li><li><a class="tocitem" href="cuda/">CUDA</a></li><li><a class="tocitem" href="faq/">F.A.Q.</a></li></ul></li><li><a class="tocitem" href="details/">Details</a></li><li><a class="tocitem" href="boot/">Bootstrap</a></li><li><a class="tocitem" href="mi/">Multiple imputation</a></li><li><a class="tocitem" href="bench/">Benchmark</a></li><li><a class="tocitem" href="validation/">Validation</a></li><li><a class="tocitem" href="api/">API</a></li><li><a class="tocitem" href="ref/">Citation &amp; Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/PharmCat/Metida.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/PharmCat/Metida.jl/blob/master/docs/src/index.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Metida"><a class="docs-heading-anchor" href="#Metida">Metida</a><a id="Metida-1"></a><a class="docs-heading-anchor-permalink" href="#Metida" title="Permalink"></a></h1><h2 id="Mixed-Models"><a class="docs-heading-anchor" href="#Mixed-Models">Mixed Models</a><a id="Mixed-Models-1"></a><a class="docs-heading-anchor-permalink" href="#Mixed-Models" title="Permalink"></a></h2><p>Multilevel models (also known as hierarchical linear models, linear mixed-effect model, mixed models, nested data models, random coefficient, random-effects models, random parameter models, or split-plot designs) are statistical models of parameters that vary at more than one level. An example could be a model of student performance that contains measures for individual students as well as measures for classrooms within which the students are grouped. These models can be seen as generalizations of linear models (in particular, linear regression), although they can also extend to non-linear models. These models became much more popular after sufficient computing power and software became available. (<a href="https://en.wikipedia.org/wiki/Multilevel_model">Wiki</a>)</p><p>Metida.jl is a Julia package for fitting mixed-effects models with flexible covariance structure.</p><p>Implemented covariance structures:</p><ul><li>Scaled Identity (SI)</li><li>Diagonal (DIAG)</li><li>Autoregressive (AR)</li><li>Heterogeneous Autoregressive (ARH)</li><li>Compound Symmetry (CS)</li><li>Heterogeneous Compound Symmetry (CSH)</li><li>Autoregressive Moving Average (ARMA)</li><li>Toeplitz (TOEP)</li><li>Toeplitz Parameterized (TOEPP)</li><li>Heterogeneous Toeplitz (TOEPH)</li><li>Heterogeneous Toeplitz Parameterized (TOEPHP)</li><li>Spatial Exponential (SPEXP)</li><li>Spatial Power (SPPOW)</li><li>Spatial Gaussian (SPGAU)</li><li>Unstructured (UN) </li><li>Custom Covariance Type</li></ul><h2 id="Limitations"><a class="docs-heading-anchor" href="#Limitations">Limitations</a><a id="Limitations-1"></a><a class="docs-heading-anchor-permalink" href="#Limitations" title="Permalink"></a></h2><ul><li>Maximum length of block more than ~400 (observation-per-subject).</li><li>Observation number more than 160 000.</li><li>For MetidaCu number of blocks more than 40  (maximum length of block more than 4000).</li></ul><p>Actually Metida can fit datasets with wore than  160k observation and 40k subjects levels on PC with 64 GB RAM. This is not &quot;hard-coded&quot; limitation, but depends on your model and data structure. Fitting of big datasets can take a lot of time. Optimal dataset size is less than 100k observations with maximum length of block less than 400.</p><div class="admonition is-warning" id="Warning-514c4bd9d0bf1f01"><header class="admonition-header">Warning<a class="admonition-anchor" href="#Warning-514c4bd9d0bf1f01" title="Permalink"></a></header><div class="admonition-body"><p>Julia v1.8 or higher required.</p></div></div><h2 id="Contents"><a class="docs-heading-anchor" href="#Contents">Contents</a><a id="Contents-1"></a><a class="docs-heading-anchor-permalink" href="#Contents" title="Permalink"></a></h2><ul><li><a href="details/#Details">Details</a></li><li class="no-marker"><ul><li><a href="examples/#Example-1-Continuous-and-categorical-predictors">Example 1 - Continuous and categorical predictors</a></li><li><a href="examples/#Example-2-Two-random-factors-(Penicillin-data)">Example 2 - Two random factors (Penicillin data)</a></li><li><a href="examples/#Example-3-Repeated-ARMA/AR/ARH">Example 3 - Repeated ARMA/AR/ARH</a></li><li><a href="examples/#Example-4-SAS-relation">Example 4 - SAS relation</a></li><li class="no-marker"><ul><li><a href="examples/#Model-1">Model 1</a></li><li><a href="examples/#Model-2">Model 2</a></li><li><a href="examples/#Model-3">Model 3</a></li></ul></li><li><a href="examples/#Example-5-Working-with-Effects.jl">Example 5 - Working with Effects.jl</a></li><li><a href="examples/#Unstructured-covariance">Unstructured covariance</a></li><li><a href="examples/#Augmented-covariance-(Experimental)">Augmented covariance (Experimental)</a></li></ul></li><li><a href="validation/#Validation">Validation</a></li><li class="no-marker"><ul><li><a href="validation/#Section-1:-REML-validation-for-public-datasets-Metida-and-SPSS">Section 1: REML validation for public datasets Metida &amp; SPSS</a></li><li><a href="validation/#Section-2:-Parameters-validation-for-public-datasets-Metida-and-SPSS-and-MixedModels">Section 2: Parameters validation for public datasets Metida &amp; SPSS &amp; MixedModels</a></li><li><a href="validation/#Section-3:-Validation-with-bioequivalence-datasets-with-Metida-and-SPSS">Section 3: Validation with bioequivalence datasets with Metida &amp; SPSS</a></li></ul></li><li><a href="api/#API">API</a></li><li class="no-marker"><ul><li><a href="api/#Basic">Basic</a></li><li class="no-marker"><ul><li><a href="api/#@covstr">@covstr</a></li><li><a href="api/#@lmmformula">@lmmformula</a></li><li><a href="api/#Metida.CovarianceType">Metida.CovarianceType</a></li><li><a href="api/#LMM">LMM</a></li><li><a href="api/#VarEffect">VarEffect</a></li></ul></li><li><a href="api/#Covariance-structures">Covariance structures</a></li><li class="no-marker"><ul><li><a href="api/#Metida.Autoregressive">Metida.Autoregressive</a></li><li><a href="api/#Metida.AutoregressiveMovingAverage">Metida.AutoregressiveMovingAverage</a></li><li><a href="api/#Metida.CompoundSymmetry">Metida.CompoundSymmetry</a></li><li><a href="api/#Metida.Diag">Metida.Diag</a></li><li><a href="api/#Metida.HeterogeneousAutoregressive">Metida.HeterogeneousAutoregressive</a></li><li><a href="api/#Metida.HeterogeneousCompoundSymmetry">Metida.HeterogeneousCompoundSymmetry</a></li><li><a href="api/#Metida.HeterogeneousToeplitz">Metida.HeterogeneousToeplitz</a></li><li><a href="api/#Metida.HeterogeneousToeplitzParameterized">Metida.HeterogeneousToeplitzParameterized</a></li><li><a href="api/#Metida.ScaledIdentity">Metida.ScaledIdentity</a></li><li><a href="api/#Metida.SpatialExponential">Metida.SpatialExponential</a></li><li><a href="api/#Metida.SpatialGaussian">Metida.SpatialGaussian</a></li><li><a href="api/#Metida.SpatialPower">Metida.SpatialPower</a></li><li><a href="api/#Metida.Toeplitz">Metida.Toeplitz</a></li><li><a href="api/#Metida.ToeplitzParameterized">Metida.ToeplitzParameterized</a></li><li><a href="api/#Metida.Unstructured">Metida.Unstructured</a></li><li><a href="api/#Methods">Methods</a></li><li><a href="api/#Metida.caic">Metida.caic</a></li><li><a href="api/#Metida.coefn">Metida.coefn</a></li><li><a href="api/#Metida.dof_satter">Metida.dof_satter</a></li><li><a href="api/#Metida.estimate">Metida.estimate</a></li><li><a href="api/#Metida.getlog">Metida.getlog</a></li><li><a href="api/#Metida.gmatrix">Metida.gmatrix</a></li><li><a href="api/#Metida.hessian">Metida.hessian</a></li><li><a href="api/#Metida.lcontrast">Metida.lcontrast</a></li><li><a href="api/#Metida.nblocks">Metida.nblocks</a></li><li><a href="api/#Metida.rand">Metida.rand</a></li><li><a href="api/#Metida.rand-2">Metida.rand</a></li><li><a href="api/#Metida.raneff">Metida.raneff</a></li><li><a href="api/#Metida.raneffn">Metida.raneffn</a></li><li><a href="api/#Metida.rankx">Metida.rankx</a></li><li><a href="api/#Metida.rmatrix">Metida.rmatrix</a></li><li><a href="api/#Metida.theta">Metida.theta</a></li><li><a href="api/#Metida.thetalength">Metida.thetalength</a></li><li><a href="api/#Metida.vmatrix">Metida.vmatrix</a></li><li><a href="api/#Metida.vmatrix!">Metida.vmatrix!</a></li><li><a href="api/#Metida.m2logreml">Metida.m2logreml</a></li><li><a href="api/#Metida.logreml">Metida.logreml</a></li></ul></li><li><a href="api/#StatsAPI">StatsAPI</a></li><li class="no-marker"><ul><li><a href="api/#Metida.aic">Metida.aic</a></li><li><a href="api/#Metida.aicc">Metida.aicc</a></li><li><a href="api/#Metida.bic">Metida.bic</a></li><li><a href="api/#Metida.coef">Metida.coef</a></li><li><a href="api/#Metida.coefnames">Metida.coefnames</a></li><li><a href="api/#Metida.coeftable">Metida.coeftable</a></li><li><a href="api/#Metida.confint">Metida.confint</a></li><li><a href="api/#Metida.crossmodelmatrix">Metida.crossmodelmatrix</a></li><li><a href="api/#Metida.dof">Metida.dof</a></li><li><a href="api/#Metida.dof_residual">Metida.dof_residual</a></li><li><a href="api/#Metida.fit">Metida.fit</a></li><li><a href="api/#Metida.fit-2">Metida.fit</a></li><li><a href="api/#islinear">islinear</a></li><li><a href="api/#isfitted">isfitted</a></li><li><a href="api/#Metida.loglikelihood">Metida.loglikelihood</a></li><li><a href="api/#Metida.modelmatrix">Metida.modelmatrix</a></li><li><a href="api/#Metida.nobs">Metida.nobs</a></li><li><a href="api/#Metida.response">Metida.response</a></li><li><a href="api/#Metida.responsename">Metida.responsename</a></li><li><a href="api/#Metida.stderror">Metida.stderror</a></li><li><a href="api/#Metida.vcov">Metida.vcov</a></li></ul></li><li><a href="api/#Experimental">Experimental</a></li><li class="no-marker"><ul><li><a href="api/#Metida.SpatialExponentialD">Metida.SpatialExponentialD</a></li><li><a href="api/#Metida.SpatialGaussianD">Metida.SpatialGaussianD</a></li><li><a href="api/#Metida.SpatialPowerD">Metida.SpatialPowerD</a></li><li><a href="api/#Metida.ScaledWeightedCov">Metida.ScaledWeightedCov</a></li><li><a href="api/#Metida.ACOV">Metida.ACOV</a></li><li><a href="api/#Metida.dof_contain">Metida.dof_contain</a></li><li><a href="api/#Metida.typeiii">Metida.typeiii</a></li><li><a href="api/#Metida.MILMM">Metida.MILMM</a></li><li><a href="api/#Metida.RawCoding">Metida.RawCoding</a></li></ul></li><li><a href="api/#Not-API-functions">Not API functions</a></li><li class="no-marker"><ul><li><a href="api/#Metida.contrast">Metida.contrast</a></li><li><a href="api/#Metida.fvalue">Metida.fvalue</a></li><li><a href="api/#Metida.mulαβαtinc">Metida.mulαβαtinc</a></li><li><a href="api/#Metida.mulθ">Metida.mulθ₃</a></li><li><a href="api/#Metida.mulαtβinc">Metida.mulαtβinc</a></li><li><a href="api/#Metida.tname">Metida.tname</a></li><li><a href="api/#Metida.raneflenv">Metida.raneflenv</a></li><li><a href="api/#Metida.edistance">Metida.edistance</a></li><li><a href="api/#Metida.m2logml">Metida.m2logml</a></li><li><a href="api/#Metida.logml">Metida.logml</a></li></ul></li></ul></li></ul><p>See also:</p><ul><li><p><a href="https://github.com/JuliaStats/MixedModels.jl">MixedModels.jl</a></p></li><li><p><a href="https://github.com/JuliaStats/GLM.jl">GLM.jl</a></p></li><li><p><a href="https://github.com/joshday/SweepOperator.jl">SweepOperator.jl</a></p></li></ul><h2 id="Reference"><a class="docs-heading-anchor" href="#Reference">Reference</a><a id="Reference-1"></a><a class="docs-heading-anchor-permalink" href="#Reference" title="Permalink"></a></h2><ul><li>Gelman, A.; Hill, J. (2007). Data Analysis Using Regression and Multilevel/Hierarchical Models. New York: Cambridge University Press. pp. 235–299. ISBN 978-0-521-68689-1.</li></ul></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="instanduse/">First step »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.15.0 on <span class="colophon-date" title="Monday 3 November 2025 00:18">Monday 3 November 2025</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
