var documenterSearchIndex = {"docs":
[{"location":"cuda/#CUDA","page":"CUDA","title":"CUDA","text":"","category":"section"},{"location":"cuda/","page":"CUDA","title":"CUDA","text":"Use CuBLAS & CuSOLVER for REML calculation. Optimization with NLopt.jl.","category":"page"},{"location":"cuda/","page":"CUDA","title":"CUDA","text":"Install:","category":"page"},{"location":"cuda/","page":"CUDA","title":"CUDA","text":"using Pkg\nPkg.add(\"MetidaCu\")","category":"page"},{"location":"cuda/","page":"CUDA","title":"CUDA","text":"Using:","category":"page"},{"location":"cuda/","page":"CUDA","title":"CUDA","text":"using Metida, MetidaCu, StatsBase, StatsModels, CSV, DataFrames\ndf = CSV.File(dirname(pathof(Metida))*\"\\\\..\\\\test\\\\csv\\\\df0.csv\") |> DataFrame\nlmm = LMM(@formula(var ~ sequence + period + formulation), df;\nrandom   = VarEffect(@covstr(formulation|subject), CSH),\nrepeated = VarEffect(@covstr(formulation|subject), VC))\nfit!(lmm; solver = :cuda)","category":"page"},{"location":"api/#API","page":"API","title":"API","text":"","category":"section"},{"location":"api/#LMM","page":"API","title":"LMM","text":"","category":"section"},{"location":"api/","page":"API","title":"API","text":"LMM","category":"page"},{"location":"api/#Metida.@covstr","page":"API","title":"Metida.@covstr","text":"","category":"section"},{"location":"api/","page":"API","title":"API","text":"Metida.@covstr","category":"page"},{"location":"api/#Metida.VarEffect","page":"API","title":"Metida.VarEffect","text":"","category":"section"},{"location":"api/","page":"API","title":"API","text":"Metida.VarEffect","category":"page"},{"location":"api/#fit!","page":"API","title":"fit!","text":"","category":"section"},{"location":"api/","page":"API","title":"API","text":"fit!","category":"page"},{"location":"api/#Metida.ScaledIdentity","page":"API","title":"Metida.ScaledIdentity","text":"","category":"section"},{"location":"api/","page":"API","title":"API","text":"Metida.ScaledIdentity","category":"page"},{"location":"api/#Metida.ScaledIdentity","page":"API","title":"Metida.ScaledIdentity","text":"ScaledIdentity()\n\nScaled identity covariance type.\n\nSI = ScaledIdentity()\n\nbeginbmatrix 1  0  0  0  1  0  0  0  1 endbmatrixsigma^2\n\n\n\n\n\n","category":"function"},{"location":"api/#Metida.Diag","page":"API","title":"Metida.Diag","text":"","category":"section"},{"location":"api/","page":"API","title":"API","text":"Metida.Diag","category":"page"},{"location":"api/#Metida.Diag","page":"API","title":"Metida.Diag","text":"Diag()\n\nDiagonal covariance type.\n\nDIAG = Diag()\n\nbeginbmatrix sigma_a^2  0  0  0  sigma_b^2  0  0  0  sigma_c^2 endbmatrix\n\n\n\n\n\n","category":"function"},{"location":"api/#Metida.Autoregressive","page":"API","title":"Metida.Autoregressive","text":"","category":"section"},{"location":"api/","page":"API","title":"API","text":"Metida.Autoregressive","category":"page"},{"location":"api/#Metida.Autoregressive","page":"API","title":"Metida.Autoregressive","text":"Autoregressive()\n\nAutoregressive covariance type.\n\nAR = Autoregressive()\n\nbeginbmatrix 1  rho  rho^2  rho^3 \nrho  1  rho  rho^2  rho^2  rho  1  rho \nrho^3  rho^2  rho  1\nendbmatrixsigma^2\n\n\n\n\n\n","category":"function"},{"location":"api/#Metida.HeterogeneousAutoregressive","page":"API","title":"Metida.HeterogeneousAutoregressive","text":"","category":"section"},{"location":"api/","page":"API","title":"API","text":"Metida.HeterogeneousAutoregressive","category":"page"},{"location":"api/#Metida.HeterogeneousAutoregressive","page":"API","title":"Metida.HeterogeneousAutoregressive","text":"HeterogeneousAutoregressive()\n\nHeterogeneous autoregressive covariance type.\n\nARH = HeterogeneousAutoregressive()\n\nbeginbmatrix\nsigma_a^2  rhosigma_asigma_b  rho^2sigma_asigma_c  rho^3sigma_asigma_d \nrhosigma_bsigma_a  sigma_b^2  rhosigma_bsigma_c  rho^2sigma_bsigma_d \nrho^2sigma_csigma_a  rhosigma_csigma_b  sigma_c^2  rhosigma_csigma_d \nrho^3sigma_dsigma_a  rho^2sigma_dsigma_b  rhosigma_dsigma_c  sigma_d^2\nendbmatrix\n\n\n\n\n\n","category":"function"},{"location":"api/#Metida.CompoundSymmetry","page":"API","title":"Metida.CompoundSymmetry","text":"","category":"section"},{"location":"api/","page":"API","title":"API","text":"Metida.CompoundSymmetry","category":"page"},{"location":"api/#Metida.CompoundSymmetry","page":"API","title":"Metida.CompoundSymmetry","text":"CompoundSymmetry()\n\nCompound symmetry covariance type.\n\nCS = CompoundSymmetry()\n\nbeginbmatrix 1  rho  rho  rho \nrho  1  rho  rho \nrho  rho  1  rho \nrho  rho  rho  1\nendbmatrixsigma^2\n\n\n\n\n\n","category":"function"},{"location":"api/#Metida.HeterogeneousCompoundSymmetry","page":"API","title":"Metida.HeterogeneousCompoundSymmetry","text":"","category":"section"},{"location":"api/","page":"API","title":"API","text":"Metida.HeterogeneousCompoundSymmetry","category":"page"},{"location":"api/#Metida.HeterogeneousCompoundSymmetry","page":"API","title":"Metida.HeterogeneousCompoundSymmetry","text":"HeterogeneousCompoundSymmetry()\n\nHeterogeneous compound symmetry covariance type.\n\nCSH = HeterogeneousCompoundSymmetry()\n\nbeginbmatrix\nsigma_a^2  rhosigma_asigma_b  rhosigma_asigma_c  rhosigma_asigma_d \nrhosigma_bsigma_a  sigma_b^2  rhosigma_bsigma_c  rhosigma_bsigma_d \nrhosigma_csigma_a  rhosigma_csigma_b  sigma_c^2  rhosigma_csigma_d \nrhosigma_dsigma_a  rhosigma_dsigma_b  rhosigma_dsigma_c  sigma_d^2\nendbmatrix\n\n\n\n\n\n","category":"function"},{"location":"api/#Metida.AutoregressiveMovingAverage","page":"API","title":"Metida.AutoregressiveMovingAverage","text":"","category":"section"},{"location":"api/","page":"API","title":"API","text":"Metida.AutoregressiveMovingAverage","category":"page"},{"location":"api/#Metida.AutoregressiveMovingAverage","page":"API","title":"Metida.AutoregressiveMovingAverage","text":"AutoregressiveMovingAverage()\n\nAutoregressive moving average covariance type.\n\nARMA = AutoregressiveMovingAverage()\n\nbeginbmatrix 1  gamma  gammarho  gammarho^2 \ngamma  1  gamma  gammarho \ngammarho  gamma  1  gamma \ngammarho^2  gammarho  gamma  1\nendbmatrixsigma^2\n\n\n\n\n\n","category":"function"},{"location":"api/#Metida.Toeplitz","page":"API","title":"Metida.Toeplitz","text":"","category":"section"},{"location":"api/","page":"API","title":"API","text":"Metida.Toeplitz","category":"page"},{"location":"api/#Metida.Toeplitz","page":"API","title":"Metida.Toeplitz","text":"Toeplitz()\n\nToeplitz covariance type. Only for G matrix.\n\nTOEP = Toeplitz()\n\n\n\n\n\n","category":"function"},{"location":"api/#Metida.ToeplitzParameterized","page":"API","title":"Metida.ToeplitzParameterized","text":"","category":"section"},{"location":"api/","page":"API","title":"API","text":"Metida.ToeplitzParameterized","category":"page"},{"location":"api/#Metida.ToeplitzParameterized","page":"API","title":"Metida.ToeplitzParameterized","text":"ToeplitzParameterized(p::Int)\n\nToeplitz covariance type with parameter p, (number of bands = p - 1, if p = 1 its equal SI structure).\n\nTOEPP(p) = ToeplitzParameterized(p)\n\n\n\n\n\n","category":"function"},{"location":"api/#Metida.isfitted","page":"API","title":"Metida.isfitted","text":"","category":"section"},{"location":"api/","page":"API","title":"API","text":"Metida.isfitted","category":"page"},{"location":"api/#StatsBase.isfitted","page":"API","title":"StatsBase.isfitted","text":"StatsBase.isfitted(lmm::LMM)\n\n\n\n\n\n","category":"function"},{"location":"api/#Metida.coef","page":"API","title":"Metida.coef","text":"","category":"section"},{"location":"api/","page":"API","title":"API","text":"Metida.coef","category":"page"},{"location":"api/#StatsBase.coef","page":"API","title":"StatsBase.coef","text":"StatsBase.coef(lmm::LMM) = copy(lmm.result.beta)\n\nModel coefficients (β).\n\n\n\n\n\n","category":"function"},{"location":"api/#Metida.coefnames","page":"API","title":"Metida.coefnames","text":"","category":"section"},{"location":"api/","page":"API","title":"API","text":"Metida.coefnames","category":"page"},{"location":"api/#StatsBase.coefnames","page":"API","title":"StatsBase.coefnames","text":"StatsBase.coefnames(lmm::LMM) = StatsBase.coefnames(lmm.mf)\n\nCoefficients names.\n\n\n\n\n\n","category":"function"},{"location":"api/#Metida.nobs","page":"API","title":"Metida.nobs","text":"","category":"section"},{"location":"api/","page":"API","title":"API","text":"Metida.nobs","category":"page"},{"location":"api/#StatsBase.nobs","page":"API","title":"StatsBase.nobs","text":"StatsBase.nobs(lmm::LMM)\n\nNumber of observations.\n\n\n\n\n\n","category":"function"},{"location":"api/#Metida.dof","page":"API","title":"Metida.dof","text":"","category":"section"},{"location":"api/","page":"API","title":"API","text":"Metida.dof","category":"page"},{"location":"api/#StatsBase.dof","page":"API","title":"StatsBase.dof","text":"StatsBase.dof(lmm::LMM)\n\nDOF.\n\n\n\n\n\n","category":"function"},{"location":"api/#Metida.dof_residual","page":"API","title":"Metida.dof_residual","text":"","category":"section"},{"location":"api/","page":"API","title":"API","text":"Metida.dof_residual","category":"page"},{"location":"api/#StatsBase.dof_residual","page":"API","title":"StatsBase.dof_residual","text":"StatsBase.dof_residual(lmm::LMM)\n\nDOF residuals.\n\n\n\n\n\n","category":"function"},{"location":"api/#Metida.dof_satter","page":"API","title":"Metida.dof_satter","text":"","category":"section"},{"location":"api/","page":"API","title":"API","text":"Metida.dof_satter","category":"page"},{"location":"api/#Metida.dof_satter","page":"API","title":"Metida.dof_satter","text":"dof_satter(lmm::LMM{T}, l) where T\n\nReturn Satterthwaite approximation for the denominator degrees of freedom, where l is a contrast vector (estimable linear combination of\ffixed effect coefficients vector).\n\nl is a contrast vector (L).\n\ndf = frac2(LCL)^2gAg\n\nA = 2H^-1\n\ng = triangledown_theta(LC^-1_thetaL)\n\n\n\n\n\n","category":"function"},{"location":"api/#Metida.dof_contain","page":"API","title":"Metida.dof_contain","text":"","category":"section"},{"location":"api/","page":"API","title":"API","text":"Metida.dof_contain","category":"page"},{"location":"api/#Metida.dof_contain","page":"API","title":"Metida.dof_contain","text":"dof_contain(lmm)\n\nwarning: Warning\nExperimental\n\nReturn the containment denominator degrees of freedom: rank(XZ) - rank(X)\n\n\n\n\n\n","category":"function"},{"location":"api/#Metida.caic","page":"API","title":"Metida.caic","text":"","category":"section"},{"location":"api/","page":"API","title":"API","text":"Metida.caic","category":"page"},{"location":"api/#Metida.caic","page":"API","title":"Metida.caic","text":"caic(lmm::LMM)\n\nConditional Akaike Information Criterion.\n\n\n\n\n\n","category":"function"},{"location":"api/#Metida.aic","page":"API","title":"Metida.aic","text":"","category":"section"},{"location":"api/","page":"API","title":"API","text":"Metida.aic","category":"page"},{"location":"api/#StatsBase.aic","page":"API","title":"StatsBase.aic","text":"StatsBase.aic(lmm::LMM)\n\nAkaike Information Criterion.\n\n\n\n\n\n","category":"function"},{"location":"api/#Metida.bic","page":"API","title":"Metida.bic","text":"","category":"section"},{"location":"api/","page":"API","title":"API","text":"Metida.bic","category":"page"},{"location":"api/#StatsBase.bic","page":"API","title":"StatsBase.bic","text":"StatsBase.bic(lmm::LMM)\n\nBayesian information criterion.\n\n\n\n\n\n","category":"function"},{"location":"api/#Metida.aicc","page":"API","title":"Metida.aicc","text":"","category":"section"},{"location":"api/","page":"API","title":"API","text":"Metida.aicc","category":"page"},{"location":"api/#StatsBase.aicc","page":"API","title":"StatsBase.aicc","text":"StatsBase.aicc(lmm::LMM)\n\nCorrected Akaike Information Criterion.\n\n\n\n\n\n","category":"function"},{"location":"api/#Metida.vcov","page":"API","title":"Metida.vcov","text":"","category":"section"},{"location":"api/","page":"API","title":"API","text":"Metida.vcov","category":"page"},{"location":"api/#StatsBase.vcov","page":"API","title":"StatsBase.vcov","text":"StatsBase.vcov(lmm::LMM)\n\nVariance-covariance matrix of β.\n\n\n\n\n\n","category":"function"},{"location":"api/#Metida.stderror","page":"API","title":"Metida.stderror","text":"","category":"section"},{"location":"api/","page":"API","title":"API","text":"Metida.stderror","category":"page"},{"location":"api/#StatsBase.stderror","page":"API","title":"StatsBase.stderror","text":"StatsBase.stderror(lmm::LMM)\n\nStandard error\n\n\n\n\n\n","category":"function"},{"location":"api/#Metida.modelmatrix","page":"API","title":"Metida.modelmatrix","text":"","category":"section"},{"location":"api/","page":"API","title":"API","text":"Metida.modelmatrix","category":"page"},{"location":"api/#StatsBase.modelmatrix","page":"API","title":"StatsBase.modelmatrix","text":"StatsBase.modelmatrix(lmm::LMM)\n\nFixed effects matrix.\n\n\n\n\n\n","category":"function"},{"location":"api/#Metida.response","page":"API","title":"Metida.response","text":"","category":"section"},{"location":"api/","page":"API","title":"API","text":"Metida.response","category":"page"},{"location":"api/#StatsBase.response","page":"API","title":"StatsBase.response","text":"StatsBase.response(lmm::LMM)\n\nResponse vector.\n\n\n\n\n\n","category":"function"},{"location":"api/#Metida.loglikelihood","page":"API","title":"Metida.loglikelihood","text":"","category":"section"},{"location":"api/","page":"API","title":"API","text":"Metida.loglikelihood","category":"page"},{"location":"api/#StatsBase.loglikelihood","page":"API","title":"StatsBase.loglikelihood","text":"StatsBase.loglikelihood(lmm::LMM)\n\nReturn loglikelihood value.\n\n\n\n\n\n","category":"function"},{"location":"api/#Metida.gmatrix","page":"API","title":"Metida.gmatrix","text":"","category":"section"},{"location":"api/","page":"API","title":"API","text":"Metida.gmatrix","category":"page"},{"location":"api/#Metida.gmatrix","page":"API","title":"Metida.gmatrix","text":"gmatrix(lmm::LMM{T}, r::Int) where T\n\n\n\n\n\n","category":"function"},{"location":"api/#Metida.rmatrix","page":"API","title":"Metida.rmatrix","text":"","category":"section"},{"location":"api/","page":"API","title":"API","text":"Metida.rmatrix","category":"page"},{"location":"api/#Metida.rmatrix","page":"API","title":"Metida.rmatrix","text":"rmatrix(lmm::LMM{T}, i::Int) where T\n\n\n\n\n\n","category":"function"},{"location":"api/#Metida.vmatrix!","page":"API","title":"Metida.vmatrix!","text":"","category":"section"},{"location":"api/","page":"API","title":"API","text":"Metida.vmatrix!","category":"page"},{"location":"api/#Metida.vmatrix!","page":"API","title":"Metida.vmatrix!","text":"vmatrix!(V, θ, lmm, i)\n\nUpdate variance-covariance matrix V for i bolock.\n\n\n\n\n\n","category":"function"},{"location":"api/#Metida.thetalength","page":"API","title":"Metida.thetalength","text":"","category":"section"},{"location":"api/","page":"API","title":"API","text":"Metida.thetalength","category":"page"},{"location":"api/#Metida.thetalength","page":"API","title":"Metida.thetalength","text":"thetalength(lmm::LMM)\n\nLength of theta vector.\n\n\n\n\n\n","category":"function"},{"location":"api/#Metida.theta","page":"API","title":"Metida.theta","text":"","category":"section"},{"location":"api/","page":"API","title":"API","text":"Metida.theta","category":"page"},{"location":"api/#Metida.theta","page":"API","title":"Metida.theta","text":"theta(lmm::LMM)\n\nReturn theta vector.\n\n\n\n\n\n","category":"function"},{"location":"api/#Metida.rankx","page":"API","title":"Metida.rankx","text":"","category":"section"},{"location":"api/","page":"API","title":"API","text":"Metida.rankx","category":"page"},{"location":"api/#Metida.rankx","page":"API","title":"Metida.rankx","text":"rankx(lmm::LMM)\n\nReturn rank of X matrix.\n\n\n\n\n\n","category":"function"},{"location":"api/#Metida.hessian","page":"API","title":"Metida.hessian","text":"","category":"section"},{"location":"api/","page":"API","title":"API","text":"Metida.hessian","category":"page"},{"location":"api/#Metida.hessian","page":"API","title":"Metida.hessian","text":"hessian(lmm, theta)\n\nCalculate Hessian matrix of REML for theta.\n\n\n\n\n\n","category":"function"},{"location":"details/#Details","page":"Details","title":"Details","text":"","category":"section"},{"location":"details/","page":"Details","title":"Details","text":"The solution to the mixed model equations is a maximum likelihood estimate when the distribution of the errors is normal. Maximum likelihood estimates are based on the probability model for the observed responses. In the probability model the distribution of the responses is expressed as a function of one or more parameters. PROC MIXED in SAS used restricted maximum likelihood (REML) approach by default. REML equation can be described with following (Henderson,  1959;Laird et.al. 1982; Jennrich 1986; Lindstrom & Bates, 1988; Gurka et.al 2006).","category":"page"},{"location":"details/","page":"Details","title":"Details","text":"Metida.jl using optimization with Optim.jl package (Newton's Method) by default.  Because variance have only positive values and ρ is limited as -1 ≤ ρ ≤ 1 in Metida.jl \"link\" function is used. Exponential values is optimizing in variance part and ρ is linked with sigmoid function. All steps perform with differentiable functions with forward automatic differentiation using ForwardDiff.jl package. Also MetidaNLopt.jl and MetidaCu.jl available for optimization with NLopt.jl and solving on CUDA GPU. Sweep algorithm using for variance-covariance matrix inversing in REML calculation.","category":"page"},{"location":"details/#Model","page":"Details","title":"Model","text":"","category":"section"},{"location":"details/","page":"Details","title":"Details","text":"In matrix notation a mixed effect model can be represented as:","category":"page"},{"location":"details/","page":"Details","title":"Details","text":"y = Xbeta + Zu + epsilon","category":"page"},{"location":"details/#V","page":"Details","title":"V","text":"","category":"section"},{"location":"details/","page":"Details","title":"Details","text":"V_i = Z_iGZ_i+R_i","category":"page"},{"location":"details/#Henderson's-«mixed-model-equations»","page":"Details","title":"Henderson's «mixed model equations»","text":"","category":"section"},{"location":"details/","page":"Details","title":"Details","text":"beginpmatrixXR^-1XXR^-1ZZR^-1XZR^-1Z+G_-1endpmatrix  beginpmatrixwidehatbeta  widehatu endpmatrix= beginpmatrixXR^-1yZR^-1yendpmatrix","category":"page"},{"location":"details/#REML","page":"Details","title":"REML","text":"","category":"section"},{"location":"details/","page":"Details","title":"Details","text":"logREML(thetabeta) = -fracN-p2 - frac12sum_i=1^nlogV_i-\n\n-frac12logsum_i=1^nX_iV_i^-1X_i-frac12sum_i=1^n(y_i - X_ibeta)V_i^-1(y_i - X_ibeta)","category":"page"},{"location":"details/#Beta-(β)","page":"Details","title":"Beta (β)","text":"","category":"section"},{"location":"details/","page":"Details","title":"Details","text":"beta = (sum_i=1^n X_iV_i^-1X_i)^-1(sum_i=1^n X_iV_i^-1y_i)","category":"page"},{"location":"details/#F","page":"Details","title":"F","text":"","category":"section"},{"location":"details/","page":"Details","title":"Details","text":"F = fracbetaL(LCL)^-1Lbetarank(LCL)","category":"page"},{"location":"details/#Variance-covariance-matrix-of-β","page":"Details","title":"Variance covariance matrix of β","text":"","category":"section"},{"location":"details/","page":"Details","title":"Details","text":"C = (sum_i=1^n X_iV_i^-1X_i)^-1","category":"page"},{"location":"details/#Sweep","page":"Details","title":"Sweep","text":"","category":"section"},{"location":"details/","page":"Details","title":"Details","text":"Details see: https://github.com/joshday/SweepOperator.jl","category":"page"},{"location":"details/#Not-API-functions","page":"Details","title":"Not API functions","text":"","category":"section"},{"location":"details/#Metida.mulαβαt3","page":"Details","title":"Metida.mulαβαt3","text":"","category":"section"},{"location":"details/","page":"Details","title":"Details","text":"Metida.mulαβαt3","category":"page"},{"location":"details/#Metida.mulαβαtinc!","page":"Details","title":"Metida.mulαβαtinc!","text":"","category":"section"},{"location":"details/","page":"Details","title":"Details","text":"Metida.mulαβαtinc!","category":"page"},{"location":"details/#Metida.mulαβαtinc!","page":"Details","title":"Metida.mulαβαtinc!","text":"θ + A * B * A'\n\nChange θ.\n\n\n\n\n\n","category":"function"},{"location":"details/#Metida.mulθ","page":"Details","title":"Metida.mulθ₃","text":"","category":"section"},{"location":"details/","page":"Details","title":"Details","text":"Metida.mulθ₃","category":"page"},{"location":"details/#Metida.mulθ₃","page":"Details","title":"Metida.mulθ₃","text":"(y - X * β)' * V * (y - X * β)\n\n\n\n\n\n","category":"function"},{"location":"details/#Metida.mulαtβinc!","page":"Details","title":"Metida.mulαtβinc!","text":"","category":"section"},{"location":"details/","page":"Details","title":"Details","text":"Metida.mulαtβinc!","category":"page"},{"location":"details/#Metida.mulαtβinc!","page":"Details","title":"Metida.mulαtβinc!","text":"θ + A' * B\n\nChange θ.\n\n\n\n\n\n","category":"function"},{"location":"nlopt/#NLopt","page":"NLopt","title":"NLopt","text":"","category":"section"},{"location":"nlopt/","page":"NLopt","title":"NLopt","text":"Optimization with NLopt.jl.","category":"page"},{"location":"nlopt/","page":"NLopt","title":"NLopt","text":"Install:","category":"page"},{"location":"nlopt/","page":"NLopt","title":"NLopt","text":"using Pkg\nPkg.add(\"MetidaNLopt\")","category":"page"},{"location":"nlopt/","page":"NLopt","title":"NLopt","text":"Using:","category":"page"},{"location":"nlopt/","page":"NLopt","title":"NLopt","text":"using Metida, MetidaNLopt, StatsBase, StatsModels, CSV, DataFrames\ndf = CSV.File(dirname(pathof(Metida))*\"\\\\..\\\\test\\\\csv\\\\df0.csv\") |> DataFrame\nlmm = LMM(@formula(var ~ sequence + period + formulation), df;\nrandom   = VarEffect(@covstr(formulation|subject), CSH),\nrepeated = VarEffect(@covstr(formulation|subject), VC))\nfit!(lmm; solver = :nlopt)","category":"page"},{"location":"examples/#Example-1-Continuous-and-categorical-predictors","page":"Examples","title":"Example 1 - Continuous and categorical predictors","text":"","category":"section"},{"location":"examples/","page":"Examples","title":"Examples","text":"using Plots, StatsPlots, Metida;\ngr()\n\nPlots.reset_defaults()\n\nrds = CSV.File(joinpath(dirname(pathof(Metida)), \"..\", \"test\", \"csv\",  \"1fptime.csv\"); types = [String, String, Float64, Float64]) |> DataFrame\n\np = @df rds plot(:time, :response, group = (:subject, :factor), colour = [:red :blue], legend = false)\n\npng(p, \"plot1.png\")\n\nrds = CSV.File(joinpath(dirname(pathof(Metida)), \"..\", \"test\", \"csv\",  \"1freparma.csv\"); types = [String, String, Float64, Float64]) |> DataFrame\n\np = @df rds plot(:time, :response, group = (:subject, :factor), colour = [:red :blue], legend = false)\n\npng(p, \"plot2.png\")","category":"page"},{"location":"examples/","page":"Examples","title":"Examples","text":"using Metida, CSV, DataFrames, MixedModels;\n\nrds = CSV.File(joinpath(dirname(pathof(Metida)), \"..\", \"test\", \"csv\",  \"1fptime.csv\"); types = [String, String, Float64, Float64]) |> DataFrame\n\nnothing; # hide","category":"page"},{"location":"examples/","page":"Examples","title":"Examples","text":"(Image: )","category":"page"},{"location":"examples/","page":"Examples","title":"Examples","text":"Metida result:","category":"page"},{"location":"examples/","page":"Examples","title":"Examples","text":"lmm = LMM(@formula(response ~1 + factor*time), rds;\nrandom = VarEffect(@covstr(1 + time|subject&factor), CSH),\n)\nfit!(lmm)","category":"page"},{"location":"examples/","page":"Examples","title":"Examples","text":"MixedModels result:","category":"page"},{"location":"examples/","page":"Examples","title":"Examples","text":"fm = @formula(response ~ 1 + factor*time + (1 + time|subject&factor))\nmm = fit(MixedModel, fm, rds, REML=true)","category":"page"},{"location":"examples/#Example-2-Two-random-factors-(Penicillin-data)","page":"Examples","title":"Example 2 - Two random factors (Penicillin data)","text":"","category":"section"},{"location":"examples/","page":"Examples","title":"Examples","text":"Metida:","category":"page"},{"location":"examples/","page":"Examples","title":"Examples","text":"\ndf          = CSV.File(joinpath(dirname(pathof(Metida)), \"..\", \"test\", \"csv\", \"Penicillin.csv\"); types = [String, Float64, String, String]) |> DataFrame\ndf.diameter = float.(df.diameter)\n\nlmm = LMM(@formula(diameter ~ 1), df;\nrandom = [VarEffect(@covstr(1|plate), SI), VarEffect(@covstr(1|sample), SI)]\n)\nfit!(lmm)","category":"page"},{"location":"examples/","page":"Examples","title":"Examples","text":"MixedModels:","category":"page"},{"location":"examples/","page":"Examples","title":"Examples","text":"\nfm2 = @formula(diameter ~ 1 + (1|plate) + (1|sample))\nmm = fit(MixedModel, fm2, df, REML=true)","category":"page"},{"location":"examples/#Example-3-Repeated-ARMA/AR/ARH","page":"Examples","title":"Example 3 - Repeated ARMA/AR/ARH","text":"","category":"section"},{"location":"examples/","page":"Examples","title":"Examples","text":"rds = CSV.File(joinpath(dirname(pathof(Metida)), \"..\", \"test\", \"csv\",  \"1freparma.csv\"); types = [String, String, Float64, Float64]) |> DataFrame\n\nnothing # hide","category":"page"},{"location":"examples/","page":"Examples","title":"Examples","text":"(Image: )","category":"page"},{"location":"examples/","page":"Examples","title":"Examples","text":"ARMA:","category":"page"},{"location":"examples/","page":"Examples","title":"Examples","text":"lmm = LMM(@formula(response ~ 1 + factor*time), rds;\nrandom = VarEffect(@covstr(factor|subject&factor), DIAG),\nrepeated = VarEffect(@covstr(1|subject&factor), ARMA),\n)\nfit!(lmm)","category":"page"},{"location":"examples/","page":"Examples","title":"Examples","text":"AR:","category":"page"},{"location":"examples/","page":"Examples","title":"Examples","text":"lmm = Metida.LMM(@formula(response ~ 1 + factor*time), rds;\nrandom = VarEffect(@covstr(factor|subject&factor), DIAG),\nrepeated = VarEffect(@covstr(1|subject&factor), AR,\n)\nfit!(lmm)","category":"page"},{"location":"examples/","page":"Examples","title":"Examples","text":"ARH:","category":"page"},{"location":"examples/","page":"Examples","title":"Examples","text":"lmm = Metida.LMM(@formula(response ~ 1 + factor*time), rds;\nrandom = VarEffect(@covstr(factor|subject&factor), DIAG),\nrepeated = VarEffect(@covstr(1|subject&factor), ARH),\n)\nfit!(lmm)","category":"page"},{"location":"examples/#Example-4-SAS-relation","page":"Examples","title":"Example 4 - SAS relation","text":"","category":"section"},{"location":"examples/#Model-1","page":"Examples","title":"Model 1","text":"","category":"section"},{"location":"examples/","page":"Examples","title":"Examples","text":"df0 = CSV.File(joinpath(dirname(pathof(Metida)), \"..\", \"test\", \"csv\", \"df0.csv\")) |> DataFrame\n\nlmm = LMM(@formula(var ~ sequence + period + formulation), df0;\nrandom   = VarEffect(@covstr(formulation|subject), CSH),\nrepeated = VarEffect(@covstr(formulation|subject), DIAG),\n)\nfit!(lmm)","category":"page"},{"location":"examples/","page":"Examples","title":"Examples","text":"SAS code:","category":"page"},{"location":"examples/","page":"Examples","title":"Examples","text":"PROC MIXED data=df0;\nCLASSES subject sequence period formulation;\nMODEL  var = sequence period formulation/ DDFM=SATTERTH s;\nRANDOM  formulation/TYPE=CSH SUB=subject G V;\nREPEATED/GRP=formulation SUB=subject R;\nRUN;","category":"page"},{"location":"examples/#Model-2","page":"Examples","title":"Model 2","text":"","category":"section"},{"location":"examples/","page":"Examples","title":"Examples","text":"lmm = LMM(\n    @formula(var ~ sequence + period + formulation), df0;\n    random   = VarEffect(@covstr(formulation|subject), SI),\n    repeated = VarEffect(@covstr(formulation|subject), DIAG),\n)\nfit!(lmm)","category":"page"},{"location":"examples/","page":"Examples","title":"Examples","text":"SAS code:","category":"page"},{"location":"examples/","page":"Examples","title":"Examples","text":"PROC MIXED data=df0;\nCLASSES subject sequence period formulation;\nMODEL  var = sequence period formulation/ DDFM=SATTERTH s;\nRANDOM  formulation/TYPE=VC SUB=subject G V;\nREPEATED/GRP=formulation SUB=subject R;\nRUN;","category":"page"},{"location":"examples/#Model-3","page":"Examples","title":"Model 3","text":"","category":"section"},{"location":"examples/","page":"Examples","title":"Examples","text":"lmm = LMM(@formula(var ~ sequence + period + formulation), df0;\n    random = VarEffect(@covstr(subject|1), SI)\n    )\nfit!(lmm)","category":"page"},{"location":"examples/","page":"Examples","title":"Examples","text":"SAS code:","category":"page"},{"location":"examples/","page":"Examples","title":"Examples","text":"PROC MIXED data=df0;\nCLASSES subject sequence period formulation;\nMODEL  var = sequence period formulation/ DDFM=SATTERTH s;\nRANDOM  subject/TYPE=VC G V;\nRUN;","category":"page"},{"location":"validation/#Validation","page":"Validation","title":"Validation","text":"","category":"section"},{"location":"validation/","page":"Validation","title":"Validation","text":"Validation provided with 3 sections:","category":"page"},{"location":"validation/","page":"Validation","title":"Validation","text":"REML validation for public datasets with Metida & SPSS\nParameters validation for public datasets Metida & SPSS & MixedModels\nValidation with bioequivalence datasets with Metida & SPSS","category":"page"},{"location":"validation/","page":"Validation","title":"Validation","text":"To run validation:","category":"page"},{"location":"validation/","page":"Validation","title":"Validation","text":"using Metida; include(joinpath(dirname(pathof(Metida)), \"..\", \"test\", \"validation.jl\"))","category":"page"},{"location":"validation/#Section-1:-REML-validation-for-public-datasets-Metida-and-SPSS","page":"Validation","title":"Section 1: REML validation for public datasets Metida & SPSS","text":"","category":"section"},{"location":"validation/#REML-result-table","page":"Validation","title":"REML result table","text":"","category":"section"},{"location":"validation/","page":"Validation","title":"Validation","text":"Model DataSet Used cov. types REML  Metida REML SPSS\n1 sleepstudy.csv SI/SI 1729.4925602367025 1729.492560\n2 sleepstudy.csv CS/SI 1904.3265170722132 1904.327\n3 sleepstudy.csv CSH/SI 1772.0953251997046 1772.095\n4 sleepstudy.csv ARH/SI 1730.1895427398322 1730.189543\n5 Pastes.csv SI,SI/SI 246.99074585348623 246.990746\n6 Pastes.csv ARMA/SI 246.81895071012508 246.818951\n7 Penicillin.csv SI,SI/SI 330.86058899109184 330.860589\n8 RepeatedPulse.csv SI/AR 453.3395435627574 453.339544\n9 RepeatedPulse.csv 0/AR 471.85107712169827 471.851077\n10 RepeatedPulse.csv AR/SI 453.3395560121246 453.339555","category":"page"},{"location":"validation/#sleepstudy.csv","page":"Validation","title":"sleepstudy.csv","text":"","category":"section"},{"location":"validation/#Model-1","page":"Validation","title":"Model 1","text":"","category":"section"},{"location":"validation/","page":"Validation","title":"Validation","text":"lmm = LMM(@formula(Reaction~Days), df;\n  random = VarEffect(@covstr(1|Subject), SI),\n  )\n  fit!(lmm)","category":"page"},{"location":"validation/","page":"Validation","title":"Validation","text":"SPSS:","category":"page"},{"location":"validation/","page":"Validation","title":"Validation","text":"MIXED Reaction BY Days\n  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(100) MXSTEP(10) SCORING(1)\n    SINGULAR(0.000000000001) HCONVERGE(0, ABSOLUTE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0.000001, ABSOLUTE)\n  /FIXED=Days | SSTYPE(3)\n  /METHOD=REML\n  /RANDOM=INTERCEPT | SUBJECT(Subject) COVTYPE(ID).","category":"page"},{"location":"validation/#Model-2","page":"Validation","title":"Model 2","text":"","category":"section"},{"location":"validation/","page":"Validation","title":"Validation","text":"lmm = LMM(@formula(Reaction~1), df;\n  random = VarEffect(Metida.@covstr(Days|Subject), CS),\n  )\n  fit!(lmm)","category":"page"},{"location":"validation/","page":"Validation","title":"Validation","text":"SPSS:","category":"page"},{"location":"validation/","page":"Validation","title":"Validation","text":"MIXED Reaction BY Days\n  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(100) MXSTEP(10) SCORING(1)\n    SINGULAR(0.000000000001) HCONVERGE(0, ABSOLUTE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0.000001, ABSOLUTE)\n  /FIXED=INTERCEPT | SSTYPE(3)\n  /METHOD=REML\n  /RANDOM=Days | SUBJECT(Subject) COVTYPE(CS).","category":"page"},{"location":"validation/#Model-3","page":"Validation","title":"Model 3","text":"","category":"section"},{"location":"validation/","page":"Validation","title":"Validation","text":"lmm = LMM(@formula(Reaction~1), df;\n  random = VarEffect(@covstr(Days|Subject), CSH)\n  )\n  fit!(lmm)","category":"page"},{"location":"validation/","page":"Validation","title":"Validation","text":"SPSS:","category":"page"},{"location":"validation/","page":"Validation","title":"Validation","text":"MIXED Reaction BY Days\n  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(100) MXSTEP(10) SCORING(1)\n    SINGULAR(0.000000000001) HCONVERGE(0, ABSOLUTE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0.000001, ABSOLUTE)\n  /FIXED=INTERCEPT | SSTYPE(3)\n  /METHOD=REML\n  /RANDOM=Days | SUBJECT(Subject) COVTYPE(CSH).","category":"page"},{"location":"validation/#Model-4","page":"Validation","title":"Model 4","text":"","category":"section"},{"location":"validation/","page":"Validation","title":"Validation","text":"lmm = LMM(@formula(Reaction~1), df;\n  random = VarEffect(@covstr(Days|Subject), ARH)\n  )\n   fit!(lmm)","category":"page"},{"location":"validation/","page":"Validation","title":"Validation","text":"SPSS:","category":"page"},{"location":"validation/","page":"Validation","title":"Validation","text":"MIXED Reaction BY Days\n  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(100) MXSTEP(10) SCORING(1)\n    SINGULAR(0.000000000001) HCONVERGE(0, ABSOLUTE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0.000001, ABSOLUTE)\n  /FIXED=INTERCEPT | SSTYPE(3)\n  /METHOD=REML\n  /RANDOM=Days | SUBJECT(Subject) COVTYPE(ARH1).","category":"page"},{"location":"validation/#pastes.csv","page":"Validation","title":"pastes.csv","text":"","category":"section"},{"location":"validation/#Model-5","page":"Validation","title":"Model 5","text":"","category":"section"},{"location":"validation/","page":"Validation","title":"Validation","text":"lmm =  LMM(@formula(strength~1), df;\nrandom = [VarEffect(@covstr(1|batch), SI),  VarEffect(@covstr(1|batch & cask), SI)]\n)\nfit!(lmm)","category":"page"},{"location":"validation/","page":"Validation","title":"Validation","text":"SPSS:","category":"page"},{"location":"validation/","page":"Validation","title":"Validation","text":"MIXED strength\n  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(100) MXSTEP(10) SCORING(1)\n    SINGULAR(0.000000000001) HCONVERGE(0, ABSOLUTE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0.000001, ABSOLUTE)\n  /FIXED=| SSTYPE(3)\n  /METHOD=REML\n  /RANDOM=INTERCEPT | SUBJECT(batch) COVTYPE(ID)\n  /RANDOM=INTERCEPT | SUBJECT(cask * batch) COVTYPE(ID).","category":"page"},{"location":"validation/#Model-6","page":"Validation","title":"Model 6","text":"","category":"section"},{"location":"validation/","page":"Validation","title":"Validation","text":"lmm =  LMM(@formula(strength~1), df;\nrandom = VarEffect(Metida.@covstr(cask|batch),  ARMA),\n)\nfit!(lmm)","category":"page"},{"location":"validation/","page":"Validation","title":"Validation","text":"SPSS:","category":"page"},{"location":"validation/","page":"Validation","title":"Validation","text":"MIXED strength by cask\n  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(100) MXSTEP(10) SCORING(1)\n    SINGULAR(0.000000000001) HCONVERGE(0, ABSOLUTE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0.000001, ABSOLUTE)\n  /FIXED=| SSTYPE(3)\n  /METHOD=REML\n  /RANDOM=cask | SUBJECT(batch) COVTYPE(ARMA11).","category":"page"},{"location":"validation/#penicillin.csv","page":"Validation","title":"penicillin.csv","text":"","category":"section"},{"location":"validation/#Model-7","page":"Validation","title":"Model 7","text":"","category":"section"},{"location":"validation/","page":"Validation","title":"Validation","text":"lmm =  LMM(@formula(diameter ~ 1), df;\nrandom = [VarEffect(@covstr(1|plate), SI), VarEffect(@covstr(1|sample), SI)]\n)\nfit!(lmm)","category":"page"},{"location":"validation/","page":"Validation","title":"Validation","text":"SPSS:","category":"page"},{"location":"validation/","page":"Validation","title":"Validation","text":"MIXED diameter\n  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(100) MXSTEP(10) SCORING(1)\n    SINGULAR(0.000000000001) HCONVERGE(0, ABSOLUTE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0.000001, ABSOLUTE)\n  /FIXED=| SSTYPE(3)\n  /METHOD=REML\n  /RANDOM=INTERCEPT | SUBJECT(plate) COVTYPE(ID)\n  /RANDOM=INTERCEPT | SUBJECT(sample) COVTYPE(ID).","category":"page"},{"location":"validation/#RepeatedPulse.csv","page":"Validation","title":"RepeatedPulse.csv","text":"","category":"section"},{"location":"validation/#Model-8","page":"Validation","title":"Model 8","text":"","category":"section"},{"location":"validation/","page":"Validation","title":"Validation","text":"sort!(df, :Day)\nlmm =  LMM(@formula(Pulse~1), df;\nrandom =  VarEffect(Metida.@covstr(Time|Time),  SI),\nrepeated =  VarEffect(Metida.@covstr(Day|Time),  AR),\n)\nfit!(lmm)","category":"page"},{"location":"validation/","page":"Validation","title":"Validation","text":"SPSS:","category":"page"},{"location":"validation/","page":"Validation","title":"Validation","text":"","category":"page"},{"location":"validation/#Model-9","page":"Validation","title":"Model 9","text":"","category":"section"},{"location":"validation/","page":"Validation","title":"Validation","text":"sort!(df, :Day)\nlmm =  LMM(@formula(Pulse~1), df;\nrepeated = VarEffect(Metida.@covstr(Day|Time),  AR),\n)\n fit!(lmm)","category":"page"},{"location":"validation/","page":"Validation","title":"Validation","text":"SPSS:","category":"page"},{"location":"validation/","page":"Validation","title":"Validation","text":"","category":"page"},{"location":"validation/#Model-10","page":"Validation","title":"Model 10","text":"","category":"section"},{"location":"validation/","page":"Validation","title":"Validation","text":"sort!(df, :Day)\nlmm =  LMM(@formula(Pulse~1), df;\nrandom =  VarEffect(Metida.@covstr(Day|Time),  AR),\n)\n fit!(lmm)","category":"page"},{"location":"validation/","page":"Validation","title":"Validation","text":"SPSS:","category":"page"},{"location":"validation/","page":"Validation","title":"Validation","text":"","category":"page"},{"location":"validation/#Section-2:-Parameters-validation-for-public-datasets-Metida-and-SPSS-and-MixedModels","page":"Validation","title":"Section 2: Parameters validation for public datasets Metida & SPSS & MixedModels","text":"","category":"section"},{"location":"validation/#Model-7-2","page":"Validation","title":"Model 7","text":"","category":"section"},{"location":"validation/","page":"Validation","title":"Validation","text":"lmm = LMM(@formula(diameter ~ 1), df;\nrandom = [VarEffect(@covstr(1|plate), SI), VarEffect(@covstr(1|sample), SI)]\n)\nfit!(lmm)","category":"page"},{"location":"validation/","page":"Validation","title":"Validation","text":"Model Parameter Value Metida Value MM Value SPSS\n7 (Intercept) estimate 22.9722  \n7 (Intercept) SE 0.808573  \n7 plate   σ² 0.716908  \n7 sample   σ² 3.73092  \n7 Residual   σ² 0.302415  \n    \n    \n    \n    \n    ","category":"page"},{"location":"validation/#Section-3:-Validation-with-bioequivalence-datasets-with-Metida-and-SPSS","page":"Validation","title":"Section 3: Validation with bioequivalence datasets with Metida & SPSS","text":"","category":"section"},{"location":"validation/#Model-BE1","page":"Validation","title":"Model BE1","text":"","category":"section"},{"location":"validation/","page":"Validation","title":"Validation","text":"lmm =  LMM(@formula(lnpk~sequence+period+treatment), dfrds;\nrandom =  VarEffect(Metida.@covstr(1|subject),  SI),\n)\nfit!(lmm)","category":"page"},{"location":"validation/#Model-BE2","page":"Validation","title":"Model BE2","text":"","category":"section"},{"location":"validation/","page":"Validation","title":"Validation","text":"lmm =  LMM(@formula(lnpk~sequence+period+treatment), dfrds;\n    random =  VarEffect(Metida.@covstr(treatment|subject),  CSH),\n    repeated =  VarEffect(Metida.@covstr(treatment|subject),  DIAG),\n    )\n     fit!(lmm)","category":"page"},{"location":"validation/#Typical-SPSS-code","page":"Validation","title":"Typical SPSS code","text":"","category":"section"},{"location":"validation/","page":"Validation","title":"Validation","text":"MIXED lnpk BY period sequence treatment subject\n  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(100) MXSTEP(10) SCORING(1)\n    SINGULAR(0.000000000001) HCONVERGE(0, ABSOLUTE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0.000001, ABSOLUTE)\n  /FIXED=period sequence treatment | SSTYPE(3)\n  /METHOD=REML\n  /RANDOM= subject(sequence) | COVTYPE(ID)\n  /EMMEANS=TABLES(treatment) COMPARE REFCAT(FIRST) ADJ(LSD).\n\nMIXED lnpk BY period treatment sequence subject\n  /CRITERIA=CIN(90) MXITER(200) MXSTEP(20) SCORING(2) SINGULAR(0.000000000001) HCONVERGE(0,\n    RELATIVE) LCONVERGE(0.0000000000001, RELATIVE) PCONVERGE(0, RELATIVE)\n  /FIXED=period treatment sequence | SSTYPE(3)\n  /METHOD=REML\n  /RANDOM=treatment | SUBJECT(subject) COVTYPE(CSH)\n  /REPEATED=treatment | SUBJECT(subject*period) COVTYPE(DIAG)\n  /EMMEANS=TABLES(treatment) COMPARE REFCAT(FIRST) ADJ(LSD).","category":"page"},{"location":"validation/#Results","page":"Validation","title":"Results","text":"","category":"section"},{"location":"validation/","page":"Validation","title":"Validation","text":"DatasSet REML Model 1\n01 530.1445193510292\n02 -30.67455875307806\n03 425.44656318173423\n04 314.22176883261096\n05 -74.87997706595712\n06 530.1445193182162\n07 1387.0928273412144\n08 2342.5993980030553\n09 2983.26033032097\n10 -16.41729812792036\n11 250.94514897106058\n12 1140.3816624784859\n13 2087.481017283834\n14 1012.351698923092\n15 2087.481017283834\n16 323.99767383075243\n17 77.56902301272578\n18 904.8743799636109\n19 782.9395904949903\n20 796.3124436472704\n21 470.59083255259935\n22 248.99027587947566\n23 119.80621157945501\n24 274.3063623684229\n25 660.046543272457\n26 433.84147581860896\n27 1123.6556434756412\n28 329.2574937705332\n29 26.96606070210349\n30 26.316526650535426","category":"page"},{"location":"validation/","page":"Validation","title":"Validation","text":"Full SPSS code provided in validation folder (here).","category":"page"},{"location":"validation/","page":"Validation","title":"Validation","text":"Validation dataset available here, 122482020427MOESM2ESM.xls.","category":"page"},{"location":"validation/#Discussion","page":"Validation","title":"Discussion","text":"","category":"section"},{"location":"validation/","page":"Validation","title":"Validation","text":"Optimization of REML function can depend on many factors. Most of all in some cases covariance parameters can be correlated (ill-conditioned/singular covariance matrix). So hypersurface in the maximum area can be very flat, that why the result can be different for different starting values (or for different software even REML is near equal). Also, some models can not be fitted for specific data at all. If the model not fitted try to check how meaningful and reasonable is the model or try to guess more robust initial conditions.","category":"page"},{"location":"ref/#Citation-and-Reference","page":"Citation & Reference","title":"Citation & Reference","text":"","category":"section"},{"location":"ref/#Sweep-algorithm","page":"Citation & Reference","title":"Sweep algorithm","text":"","category":"section"},{"location":"ref/","page":"Citation & Reference","title":"Citation & Reference","text":"Sweep based on SweepOperator.jl. Thanks to @joshday and @Hua-Zhou.\nhttp://hua-zhou.github.io/teaching/biostatm280-2019spring/slides/12-sweep/sweep.html","category":"page"},{"location":"ref/","page":"Citation & Reference","title":"Citation & Reference","text":"More:","category":"page"},{"location":"ref/","page":"Citation & Reference","title":"Citation & Reference","text":"Section 7.4-7.6 of Numerical Analysis for Statisticians by Kenneth Lange (2010).\nThe paper A tutorial on the SWEEP operator by James H. Goodnight (1979).","category":"page"},{"location":"ref/#REML-and-Parameter-estimation","page":"Citation & Reference","title":"REML & Parameter estimation","text":"","category":"section"},{"location":"ref/","page":"Citation & Reference","title":"Citation & Reference","text":"Henderson, C. R., et al. “The Estimation of Environmental and Genetic Trends from Records Subject to Culling.” Biometrics, vol. 15, no. 2, 1959, pp. 192–218. JSTOR, www.jstor.org/stable/2527669.\nLaird, Nan M., and James H. Ware. “Random-Effects Models for Longitudinal Data.” Biometrics, vol. 38, no. 4, 1982, pp. 963–974. JSTOR, www.jstor.org/stable/2529876.\nLindstrom & J.; Bates, M. (1988). Newton—Raphson and EM Algorithms for Linear Mixed-Effects Models for Repeated-Measures Data. Journal of the American Statistical Association. 83. 1014. 10.1080/01621459.1988.10478693.\nGurka, Matthew. (2006). Selecting the Best Linear Mixed Model under REML. The American Statistician. 60. 19-26. 10.1198/000313006X90396.\nSang Hong Lee, Julius H.J. van der Werf. An efficient variance component approach implementing an average information REML suitable for combined LD and linkage mapping with a general complex pedigree. Genetics Selection Evolution, BioMed Central, 2006, 38 (1), pp.25-43. ⟨hal-00894558⟩\nF.N. Gumedze, T.T. Dunne, Parameter estimation and inference in the linear mixed model, Linear Algebra and its Applications, Volume 435, Issue 8, 2011, Pages 1920-1944, ISSN 0024-3795, https://doi.org/10.1016/j.laa.2011.04.015. (http://www.sciencedirect.com/science/article/pii/S002437951100320X)","category":"page"},{"location":"ref/#AI-algorithm","page":"Citation & Reference","title":"AI algorithm","text":"","category":"section"},{"location":"ref/","page":"Citation & Reference","title":"Citation & Reference","text":"D.L. Johnson, R. Thompson, Restricted Maximum Likelihood Estimation of Variance Components for Univariate Animal Models Using Sparse Matrix Techniques and Average Information, Journal of Dairy Science, Volume 78, Issue 2, 1995, Pages 449-456, ISSN 0022-0302, https://doi.org/10.3168/jds.S0022-0302(95)76654-1. (http://www.sciencedirect.com/science/article/pii/S0022030295766541)\nMishchenko, Kateryna & Holmgren, Sverker & Rönnegård, Lars. (2007). Newton-type Methods for REML Estimation in Genetic Analysis of Quantitative Traits. Journal of Computational Methods in Science and Engineering. 8. 10.3233/JCM-2008-81-203.\nMatilainen K, Mäntysaari EA, Lidauer MH, Strandén I, Thompson R. Employing a Monte Carlo algorithm in Newton-type methods for restricted maximum likelihood estimation of genetic parameters. PLoS One. 2013;8(12):e80821. Published 2013 Dec 10. doi:10.1371/journal.pone.0080821","category":"page"},{"location":"ref/#Covariance-structures","page":"Citation & Reference","title":"Covariance structures","text":"","category":"section"},{"location":"ref/","page":"Citation & Reference","title":"Citation & Reference","text":"Wolfinger, Russ. (1993). Covariance structure selection in general mixed models. Communications in Statistics-simulation and Computation - COMMUN STATIST-SIMULAT COMPUT. 22. 1079-1106. 10.1080/03610919308813143.\nLittell, Ramon & Pendergast, Jane & Natarajan, Ranjini. (2000). Modelling covariance structure in the analysis of repeated measures data. Statistics in Medicine. 19. 1793-1819. 10.1002/1097-0258(20000715)19:13%3C1793::AID-SIM482%3E3.0.CO;2-Q.\nQUINTAL, SILVANA SILVA RED, VIANA, ALEXANDRE PIO, CAMPOS, BIANCA MACHADO, VIVAS, MARCELO, & AMARAL JÚNIOR, ANTONIO TEIXEIRA DO. (2017). ANALYSIS OF STRUCTURES OF COVARIANCE AND REPEATABILITY IN GUAVA SEGREGANTING POPULATION. Revista Caatinga, 30(4), 885-891. https://doi.org/10.1590/1983-21252017v30n408rc\nMcNeish, D., Harring, J. Covariance pattern mixture models: Eliminating random effects to improve convergence and performance. Behav Res 52, 947–979 (2020). https://doi.org/10.3758/s13428-019-01292-4","category":"page"},{"location":"ref/#And-more","page":"Citation & Reference","title":"And more","text":"","category":"section"},{"location":"ref/","page":"Citation & Reference","title":"Citation & Reference","text":"Giesbrecht, F. G., and Burns, J. C. (1985), \"Two-Stage Analysis Based on a Mixed Model: Large-sample Asymptotic Theory and Small-Sample Simulation Results,\" Biometrics, 41, 853-862.\nJennrich, R., & Schluchter, M. (1986). Unbalanced Repeated-Measures Models with Structured Covariance Matrices. Biometrics, 42(4), 805-820. doi:10.2307/2530695\nFletcher, Roger (1987), Practical methods of optimization (2nd ed.), New York: John Wiley & Sons, ISBN 978-0-471-91547-8\nWolfinger et al., (1994) Computing gaussian likelihoods and their derivatives for general linear mixed models doi: 10.1137/0915079\nHrong-Tai Fai & Cornelius (1996) Approximate F-tests of multiple degree of freedom hypotheses in generalized least squares analyses of unbalanced split-plot experiments, Journal of Statistical Computation and Simulation, 54:4, 363-378, DOI: 10.1080/00949659608811740\nSchaalje GB, McBride JB, Fellingham GW. Adequacy of approximations to distributions of test statistics in complex mixed linear models. J Agric Biol Environ Stat. 2002;7:512–24.\nWright, Stephen, and Jorge Nocedal (2006) \"Numerical optimization.\" Springer\nVan Peer, A. (2010), Variability and Impact on Design of Bioequivalence Studies. Basic & Clinical Pharmacology & Toxicology, 106: 146-153. doi:10.1111/j.1742-7843.2009.00485.x","category":"page"},{"location":"ref/#Julia-packages","page":"Citation & Reference","title":"Julia packages","text":"","category":"section"},{"location":"ref/","page":"Citation & Reference","title":"Citation & Reference","text":"Revels, Jarrett & Lubin, Miles & Papamarkou, Theodore. (2016). Forward-Mode Automatic Differentiation in Julia.\nMogensen et al., (2018). Optim: A mathematical optimization package for Julia. Journal of Open Source Software, 3(24), 615,doi: 10.21105/joss.00615","category":"page"},{"location":"ref/#CuSolver-and-CuBLAS","page":"Citation & Reference","title":"CuSolver & CuBLAS","text":"","category":"section"},{"location":"ref/","page":"Citation & Reference","title":"Citation & Reference","text":"https://docs.nvidia.com/cuda/cusolver/index.html\nhttps://docs.nvidia.com/cuda/cublas/index.htm","category":"page"},{"location":"ref/#Reference-dataset","page":"Citation & Reference","title":"Reference dataset","text":"","category":"section"},{"location":"ref/","page":"Citation & Reference","title":"Citation & Reference","text":"Bioequivalence reference datasets: Schütz, H., Labes, D., Tomashevskiy, M. et al. Reference Datasets for Studies in a Replicate Design Intended for Average Bioequivalence with Expanding Limits. AAPS J 22, 44 (2020). https://doi.org/10.1208/s12248-020-0427-6\nsleepstudy.csv: Gregory Belenky, Nancy J. Wesensten, David R. Thorne, Maria L. Thomas, Helen C. Sing, Daniel P. Redmond, Michael B. Russo and Thomas J. Balkin (2003) Patterns of performance degradation and restoration during sleep restriction and subsequent recovery: a sleep dose-response study. Journal of Sleep Research 12, 1–12.\nPenicillin.csv: O.L. Davies and P.L. Goldsmith (eds), Statistical Methods in Research and Production, 4th ed., Oliver and Boyd, (1972), section 6.6\nPastes.csv: O.L. Davies and P.L. Goldsmith (eds), Statistical Methods in Research and Production, 4th ed., Oliver and Boyd, (1972), section 6.5\nChickWeight.csv:\nCrowder, M. and Hand, D. (1990), Analysis of Repeated Measures, Chapman and Hall (example 5.3)\nHand, D. and Crowder, M. (1996), Practical Longitudinal Data Analysis, Chapman and Hall (table A.2)\nPinheiro, J. C. and Bates, D. M. (2000) Mixed-effects Models in S and S-PLUS, Springer.\nRepeatedPulse.csv: Data supplied by a student at Oberlin College.","category":"page"},{"location":"ref/","page":"Citation & Reference","title":"Citation & Reference","text":"See also: https://vincentarelbundock.github.io/Rdatasets/datasets.html","category":"page"},{"location":"bench/#Benchmark","page":"Benchmark","title":"Benchmark","text":"","category":"section"},{"location":"bench/","page":"Benchmark","title":"Benchmark","text":"Data","category":"page"},{"location":"bench/","page":"Benchmark","title":"Benchmark","text":"using Metida, CSV, DataFrames, MixedModels;\n\nrds = CSV.File(joinpath(dirname(pathof(Metida)), \"..\", \"test\", \"csv\",  \"1fptime.csv\"); types = [String, String, Float64, Float64]) |> DataFrame","category":"page"},{"location":"bench/","page":"Benchmark","title":"Benchmark","text":"MixedModels","category":"page"},{"location":"bench/","page":"Benchmark","title":"Benchmark","text":"fm = @formula(response ~ 1 + factor*time + (1 + time|subject&factor))\n@benchmark mm = fit($MixedModel, $fm, $rds, REML=true) seconds = 15","category":"page"},{"location":"bench/","page":"Benchmark","title":"Benchmark","text":"BenchmarkTools.Trial:\n  memory estimate:  375.98 KiB\n  allocs estimate:  3544\n  --------------\n  minimum time:     4.797 ms (0.00% GC)\n  median time:      5.232 ms (0.00% GC)\n  mean time:        5.469 ms (1.43% GC)\n  maximum time:     32.592 ms (78.90% GC)\n  --------------\n  samples:          2741\n  evals/sample:     1","category":"page"},{"location":"bench/","page":"Benchmark","title":"Benchmark","text":"Metida v0.4.0","category":"page"},{"location":"bench/","page":"Benchmark","title":"Benchmark","text":"lmm = LMM(@formula(response ~1 + factor*time), rds;\nrandom = VarEffect(@covstr(1 + time|subject&factor), CSH),\n)\n@benchmark fit!($lmm, hcalck = false) seconds = 15","category":"page"},{"location":"bench/","page":"Benchmark","title":"Benchmark","text":"BenchmarkTools.Trial:\n  memory estimate:  74.98 MiB\n  allocs estimate:  112761\n  --------------\n  minimum time:     198.118 ms (0.00% GC)\n  median time:      212.742 ms (3.56% GC)\n  mean time:        212.262 ms (2.83% GC)\n  maximum time:     225.154 ms (4.37% GC)\n  --------------\n  samples:          71\n  evals/sample:     1","category":"page"},{"location":"bench/","page":"Benchmark","title":"Benchmark","text":"MetidaNLopt v0.4.0","category":"page"},{"location":"bench/","page":"Benchmark","title":"Benchmark","text":"@benchmark fit!($lmm, solver = :nlopt) seconds = 15","category":"page"},{"location":"bench/","page":"Benchmark","title":"Benchmark","text":"BenchmarkTools.Trial:\n  memory estimate:  9.12 MiB\n  allocs estimate:  53289\n  --------------\n  minimum time:     113.572 ms (0.00% GC)\n  median time:      129.960 ms (0.00% GC)\n  mean time:        131.570 ms (1.13% GC)\n  maximum time:     167.145 ms (0.00% GC)\n  --------------\n  samples:          114\n  evals/sample:     1","category":"page"},{"location":"bench/","page":"Benchmark","title":"Benchmark","text":"MetidaCu v0.4.0","category":"page"},{"location":"bench/","page":"Benchmark","title":"Benchmark","text":"@benchmark fit!($lmm, solver = :cuda) seconds = 15","category":"page"},{"location":"bench/","page":"Benchmark","title":"Benchmark","text":"BenchmarkTools.Trial:\n  memory estimate:  26.44 MiB\n  allocs estimate:  527567\n  --------------\n  minimum time:     3.782 s (0.00% GC)\n  median time:      3.911 s (0.00% GC)\n  mean time:        3.947 s (0.32% GC)\n  maximum time:     4.183 s (1.20% GC)\n  --------------\n  samples:          4\n  evals/sample:     1","category":"page"},{"location":"bench/","page":"Benchmark","title":"Benchmark","text":"Metida v0.5.0","category":"page"},{"location":"bench/","page":"Benchmark","title":"Benchmark","text":"lmm = LMM(@formula(response ~1 + factor*time), rds;\nrandom = VarEffect(@covstr(1 + time|subject&factor), CSH),\n)\n@benchmark fit!($lmm, hes = false) seconds = 15","category":"page"},{"location":"bench/","page":"Benchmark","title":"Benchmark","text":"BenchmarkTools.Trial:\n  memory estimate:  74.93 MiB\n  allocs estimate:  111421\n  --------------\n  minimum time:     196.160 ms (0.00% GC)\n  median time:      218.341 ms (0.00% GC)\n  mean time:        225.815 ms (3.55% GC)\n  maximum time:     305.821 ms (19.83% GC)\n  --------------\n  samples:          67\n  evals/sample:     1","category":"page"},{"location":"bench/#Conclusion","page":"Benchmark","title":"Conclusion","text":"","category":"section"},{"location":"bench/","page":"Benchmark","title":"Benchmark","text":"MixedModels.jl faster than Metida.jl in similar cases, but Metida.jl can be used with different covariance structures for random and repeated effects. MetidaNLopt have better performance but not estimate Hessian matrix of REML. MetidaCu have advantage only for big observation-pes-subject number.","category":"page"},{"location":"#Metida","page":"Home","title":"Metida","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"CurrentModule = Metida","category":"page"},{"location":"#Mixed-Models","page":"Home","title":"Mixed Models","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Multilevel models (also known as hierarchical linear models, linear mixed-effect model, mixed models, nested data models, random coefficient, random-effects models, random parameter models, or split-plot designs) are statistical models of parameters that vary at more than one level. An example could be a model of student performance that contains measures for individual students as well as measures for classrooms within which the students are grouped. These models can be seen as generalizations of linear models (in particular, linear regression), although they can also extend to non-linear models. These models became much more popular after sufficient computing power and software became available. (Wiki)","category":"page"},{"location":"","page":"Home","title":"Home","text":"Metida.jl is a Julia package for fitting mixed-effects models with flexible covariance structure.","category":"page"},{"location":"","page":"Home","title":"Home","text":"Implemented covariance structures:","category":"page"},{"location":"","page":"Home","title":"Home","text":"Scaled Identity (SI)\nDiagonal (DIAG)\nAutoregressive (AR)\nHeterogeneous Autoregressive (ARH)\nCompound Symmetry (CS)\nHeterogeneous Compound Symmetry (CSH)\nAutoregressive Moving Average (ARMA)\nToeplitz (TOEP)\nToeplitzParameterized (TOEPP)\nCustomCovarianceType","category":"page"},{"location":"#Contents","page":"Home","title":"Contents","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Pages = [\n        \"details.md\",\n        \"examples.md\",\n        \"validation.md\",\n        \"api.md\"]\nDepth = 3","category":"page"},{"location":"","page":"Home","title":"Home","text":"See also:","category":"page"},{"location":"","page":"Home","title":"Home","text":"MixedModels.jl\nGLM.jl\nSweepOperator.jl","category":"page"},{"location":"#Reference","page":"Home","title":"Reference","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Gelman, A.; Hill, J. (2007). Data Analysis Using Regression and Multilevel/Hierarchical Models. New York: Cambridge University Press. pp. 235–299. ISBN 978-0-521-68689-1.","category":"page"},{"location":"instanduse/#Installation","page":"First step","title":"Installation","text":"","category":"section"},{"location":"instanduse/","page":"First step","title":"First step","text":"import Pkg; Pkg.add(\"Metida\")","category":"page"},{"location":"instanduse/#Simple-example","page":"First step","title":"Simple example","text":"","category":"section"},{"location":"instanduse/","page":"First step","title":"First step","text":"LMM\nMetida.@covstr\nMetida.VarEffect\nfit!","category":"page"},{"location":"instanduse/#Step-1:-Load-data","page":"First step","title":"Step 1: Load data","text":"","category":"section"},{"location":"instanduse/","page":"First step","title":"First step","text":"Load provided data with CSV and DataFrames:","category":"page"},{"location":"instanduse/","page":"First step","title":"First step","text":"using Metida, CSV, DataFrames\n\ndf = CSV.File(joinpath(dirname(pathof(Metida)), \"..\", \"test\", \"csv\", \"df0.csv\")) |> DataFrame;\nnothing # hide","category":"page"},{"location":"instanduse/","page":"First step","title":"First step","text":"note: Note\nCheck that all categorical variables is categorical.","category":"page"},{"location":"instanduse/","page":"First step","title":"First step","text":"categorical!(df, :subject);\ncategorical!(df, :period);\ncategorical!(df, :sequence);\ncategorical!(df, :formulation);\nnothing # hide","category":"page"},{"location":"instanduse/#Step-2:-Make-model","page":"First step","title":"Step 2: Make model","text":"","category":"section"},{"location":"instanduse/","page":"First step","title":"First step","text":"lmm = LMM(@formula(var~sequence+period+formulation), df;\nrandom = VarEffect(@covstr(formulation|subject), CSH),\nrepeated = VarEffect(@covstr(formulation|subject), DIAG));","category":"page"},{"location":"instanduse/#Step-3:-Fit","page":"First step","title":"Step 3: Fit","text":"","category":"section"},{"location":"instanduse/","page":"First step","title":"First step","text":"fit!(lmm)","category":"page"},{"location":"instanduse/#Check-warnings-and-errors-in-log.","page":"First step","title":"Check warnings and errors in log.","text":"","category":"section"},{"location":"instanduse/","page":"First step","title":"First step","text":"lmm.log","category":"page"},{"location":"instanduse/#Model-construction","page":"First step","title":"Model construction","text":"","category":"section"},{"location":"instanduse/","page":"First step","title":"First step","text":"Metida.LMM","category":"page"},{"location":"instanduse/#Metida.LMM","page":"First step","title":"Metida.LMM","text":"LMM(model, data; contrasts=Dict{Symbol,Any}(),  random::Union{Nothing, VarEffect, Vector{VarEffect}} = nothing, repeated::Union{Nothing, VarEffect} = nothing)\n\nMake Linear-Mixed Model object.\n\nmodel: is a fixed-effect model (@formula)\n\ndata: tabular data\n\ncontrasts: contrasts for fixed factors\n\nrandom: vector of random effects or single random effect\n\nrepeated: is a repeated effect (only one)\n\n\n\n\n\n","category":"type"},{"location":"instanduse/","page":"First step","title":"First step","text":"model - example: @formula(var ~ sequence + period + formulation)\nrandom - effects can be specified like this: VarEffect(@covstr(formulation|subject), CSH). @covstr is a effect model: @covstr(formulation|subject). CSH is a  CovarianceType structure. Premade constants: SI, DIAG, AR, ARH, CS, CSH, ARMA. If not specified only repeated used.\nrepeated - can be specified like random effect. If not specified VarEffect(@covstr(1|1), SI) used. If no repeated effects specified vector of ones used.","category":"page"},{"location":"instanduse/#Random/repeated-model","page":"First step","title":"Random/repeated model","text":"","category":"section"},{"location":"instanduse/","page":"First step","title":"First step","text":"Metida.@covstr","category":"page"},{"location":"instanduse/#Metida.@covstr","page":"First step","title":"Metida.@covstr","text":"@covstr(ex)\n\nMacros for random/repeated effect model.\n\nExample: @covstr(factor|subject)\n\n\n\n\n\n","category":"macro"},{"location":"instanduse/#Random/repeated-effect-construction","page":"First step","title":"Random/repeated effect construction","text":"","category":"section"},{"location":"instanduse/","page":"First step","title":"First step","text":"Metida.VarEffect","category":"page"},{"location":"instanduse/#Metida.VarEffect","page":"First step","title":"Metida.VarEffect","text":"VarEffect(formula, covtype::T, coding) where T <: AbstractCovarianceType\n\nVarEffect(formula, covtype::T; coding = nothing) where T <: AbstractCovarianceType\n\nVarEffect(formula; coding = nothing)\n\nRandom/repeated effect.\n\nformula from @covstr(ex) macros.\ncovtype - covariance type (SI, DIAG, CS, CSH, AR, ARH, ARMA)\n\n\n\n\n\n","category":"type"},{"location":"instanduse/#Fitting","page":"First step","title":"Fitting","text":"","category":"section"},{"location":"instanduse/","page":"First step","title":"First step","text":"Metida.fit!","category":"page"},{"location":"instanduse/#StatsBase.fit!","page":"First step","title":"StatsBase.fit!","text":"fit!(lmm::LMM{T};\nsolver::Symbol = :default,\nverbose = :auto,\nvarlinkf = :exp,\nrholinkf = :sigm,\naifirst::Bool = false,\ng_tol::Float64 = 1e-12,\nx_tol::Float64 = 1e-12,\nf_tol::Float64 = 1e-12,\nhes::Bool   = true,\ninit = nothing,\nio::IO = stdout,\n) where T\n\nFit LMM model.\n\nsolver - :default / :nlopt / :cuda\nverbose - :auto / 1 / 2 / 3\nvarlinkf - not implemented\nrholinkf - :sigm / :atan\naifirst - first iteration with AI-like method\ng_tol - absolute tolerance in the gradient\nx_tol - absolute tolerance of theta vector\nf_tol - absolute tolerance in changes of the REML\nhes - calculate REML Hessian\ninit - initial theta values\nio - uotput IO\n\n\n\n\n\n","category":"function"},{"location":"instanduse/","page":"First step","title":"First step","text":"solver - :default solving with Optim.jl, for :nlopt and :cuda MetidaNLopt.jl and MetidaCu.jl should be installed.\nverbose - 1 - only log,  2 - log and print,  3 - print only errors, other log, 0 (or any other value) - no logging.","category":"page"},{"location":"instanduse/#Custom-structure","page":"First step","title":"Custom structure","text":"","category":"section"},{"location":"instanduse/#Step-1:-make-CustomCovarianceStruct","page":"First step","title":"Step 1: make CustomCovarianceStruct","text":"","category":"section"},{"location":"instanduse/","page":"First step","title":"First step","text":"Metida.CustomCovarianceStruct","category":"page"},{"location":"instanduse/#Metida.CustomCovarianceStruct","page":"First step","title":"Metida.CustomCovarianceStruct","text":"CustomCovarianceStruct(nparamf::Function, xmat!::Function)\n\nnparamf - function type (t, q) -> (a, b)\n\nwhere: t - size(z, 2) - number of levels for effect (number of columns of individual z matriz); q - number of factors in the effect model; a - number of variance parameters; b - number of ρ parameters;\n\nExample: (t, q) -> (t, 1) for CSH structure; (t, q) -> (1, 1) for AR, ets.\n\nTuple{Int, Int} should be returned.\n\nxmat! - construction function\n\nG matrix function should update mx, where mx is zero matrix, p - parameter of CovarianceType structure, example:\n\nfunction gmat_diag!(mx, θ::Vector{T}, p) where T\n    for i = 1:size(mx, 1)\n            mx[i, i] = θ[i] ^ 2\n        end\n    nothing\nend\n\nR matrix function should add R part to mx, rz - is repeated effect matrix, example:\n\nfunction rmatp_diag!(mx, θ::Vector{T}, rz, p) where T\n    for i = 1:size(mx, 1)\n        for c = 1:length(θ)\n            mx[i, i] += rz[i, c] * θ[c] * θ[c]\n        end\n    end\n    nothing\nend\n\n\n\n\n\n","category":"type"},{"location":"instanduse/#Step-2:-make-CustomCovarianceType","page":"First step","title":"Step 2: make CustomCovarianceType","text":"","category":"section"},{"location":"instanduse/","page":"First step","title":"First step","text":"Metida.CustomCovarianceType","category":"page"},{"location":"instanduse/#Metida.CustomCovarianceType","page":"First step","title":"Metida.CustomCovarianceType","text":"CustomCovarianceType(ccs::CustomCovarianceStruct)\n\nMake custom covariance type with CustomCovarianceStruct.\n\n\n\n\n\n","category":"function"},{"location":"instanduse/#Step-3-Fit-your-model","page":"First step","title":"Step 3 Fit your model","text":"","category":"section"},{"location":"instanduse/","page":"First step","title":"First step","text":"using Metida, CSV, DataFrames # hide\n\ndf0 = CSV.File(joinpath(dirname(pathof(Metida)), \"..\", \"test\", \"csv\",  \"df0.csv\"); types = [String, String, String, String, Float64, Float64]) |> DataFrame\n\n#Make struct for G and R matrix\nccsg = CustomCovarianceStruct((q,p) -> (q, 1), Metida.gmat_csh!)\nccsr = CustomCovarianceStruct((q,p) -> (q, 0), Metida.rmatp_diag!)\n\n#Make type struct\nCCTG = CustomCovarianceType(ccsg)\nCCTR = CustomCovarianceType(ccsr)\n\n#Make model\nlmm = LMM(@formula(var~sequence+period+formulation), df0;\nrandom = VarEffect(@covstr(formulation|subject), CCTG),\nrepeated = VarEffect(@covstr(formulation|subject), CCTR),\n)\n\n#Fit model\nfit!(lmm)","category":"page"}]
}
