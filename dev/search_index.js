var documenterSearchIndex = {"docs":
[{"location":"cuda/#CUDA","page":"CUDA","title":"CUDA","text":"","category":"section"},{"location":"cuda/","page":"CUDA","title":"CUDA","text":"Use CuBLAS & CuSOLVER for REML calculation. Optimization with NLopt.jl.","category":"page"},{"location":"cuda/","page":"CUDA","title":"CUDA","text":"Install:","category":"page"},{"location":"cuda/","page":"CUDA","title":"CUDA","text":"using Pkg\nPkg.add(\"MetidaCu\")","category":"page"},{"location":"cuda/","page":"CUDA","title":"CUDA","text":"Using:","category":"page"},{"location":"cuda/","page":"CUDA","title":"CUDA","text":"using Metida, MetidaCu, StatsBase, StatsModels, CSV, DataFrames\ndf = CSV.File(dirname(pathof(Metida))*\"\\\\..\\\\test\\\\csv\\\\df0.csv\") |> DataFrame\nlmm = LMM(@formula(var ~ sequence + period + formulation), df;\nrandom   = VarEffect(@covstr(formulation), CSH),\nrepeated = VarEffect(@covstr(formulation), VC),\nsubject  = :subject)\n\nfit!(lmm; solver = :cuda)","category":"page"},{"location":"api/#API","page":"API","title":"API","text":"","category":"section"},{"location":"api/#Metida.LMM","page":"API","title":"Metida.LMM","text":"","category":"section"},{"location":"api/","page":"API","title":"API","text":"Metida.LMM","category":"page"},{"location":"api/#Metida.LMM","page":"API","title":"Metida.LMM","text":"LMM(model, data; contrasts=Dict{Symbol,Any}(), subject::Union{Nothing, Symbol} = nothing,  random::Union{Nothing, VarEffect, Vector{VarEffect}} = nothing, repeated::Union{Nothing, VarEffect} = nothing)\n\nMake Linear-Mixed Model object.\n\nmodel: is a fixed-effect model (@formula)\n\ndata: tabular data\n\ncontrasts: contrasts for fixed factors\n\nrandom: vector of random effects or single random effect\n\nrepeated: is a repeated effect (only one)\n\nsubject: is a block-diagonal factor\n\n\n\n\n\n","category":"type"},{"location":"api/#Metida.fit!","page":"API","title":"Metida.fit!","text":"","category":"section"},{"location":"api/","page":"API","title":"API","text":"Metida.fit!","category":"page"},{"location":"api/#StatsBase.fit!","page":"API","title":"StatsBase.fit!","text":"fit!(lmm::LMM{T};\nsolver::Symbol = :default,\nverbose = :auto,\nvarlinkf = :exp,\nrholinkf = :sigm,\naifirst::Bool = false,\ng_tol::Float64 = 1e-12,\nx_tol::Float64 = 1e-12,\nf_tol::Float64 = 1e-12,\nhcalck::Bool   = true,\ninit = nothing,\nio::IO = stdout) where T\n\nFit LMM model.\n\nrholinkf - :sigm / :atan\n\n\n\n\n\n","category":"function"},{"location":"api/#Metida.@covstr","page":"API","title":"Metida.@covstr","text":"","category":"section"},{"location":"api/","page":"API","title":"API","text":"Metida.@covstr","category":"page"},{"location":"api/#Metida.@covstr","page":"API","title":"Metida.@covstr","text":"@covstr(ex)\n\nMacros for random/repeated effect model.\n\n\n\n\n\n","category":"macro"},{"location":"api/#Metida.VarEffect","page":"API","title":"Metida.VarEffect","text":"","category":"section"},{"location":"api/","page":"API","title":"API","text":"Metida.VarEffect","category":"page"},{"location":"api/#Metida.VarEffect","page":"API","title":"Metida.VarEffect","text":"VarEffect(model, covtype::T, coding; fulldummy = true, subj = nothing) where T <: AbstractCovarianceType\n\nRandom/repeated effect.\n\n\n\n\n\n","category":"type"},{"location":"api/#Metida.ScaledIdentity","page":"API","title":"Metida.ScaledIdentity","text":"","category":"section"},{"location":"api/","page":"API","title":"API","text":"Metida.ScaledIdentity","category":"page"},{"location":"api/#Metida.ScaledIdentity","page":"API","title":"Metida.ScaledIdentity","text":"ScaledIdentity()\n\nScaled identity covariance type.\n\nSI = ScaledIdentity()\n\n\n\n\n\n","category":"function"},{"location":"api/#Metida.Diag","page":"API","title":"Metida.Diag","text":"","category":"section"},{"location":"api/","page":"API","title":"API","text":"Metida.Diag","category":"page"},{"location":"api/#Metida.Diag","page":"API","title":"Metida.Diag","text":"Diag()\n\n\n\n\n\n","category":"function"},{"location":"api/#Metida.Autoregressive","page":"API","title":"Metida.Autoregressive","text":"","category":"section"},{"location":"api/","page":"API","title":"API","text":"Metida.Autoregressive","category":"page"},{"location":"api/#Metida.Autoregressive","page":"API","title":"Metida.Autoregressive","text":"Autoregressive()\n\n\n\n\n\n","category":"function"},{"location":"api/#Metida.HeterogeneousAutoregressive","page":"API","title":"Metida.HeterogeneousAutoregressive","text":"","category":"section"},{"location":"api/","page":"API","title":"API","text":"Metida.HeterogeneousAutoregressive","category":"page"},{"location":"api/#Metida.HeterogeneousAutoregressive","page":"API","title":"Metida.HeterogeneousAutoregressive","text":"HeterogeneousAutoregressive()\n\n\n\n\n\n","category":"function"},{"location":"api/#Metida.CompoundSymmetry","page":"API","title":"Metida.CompoundSymmetry","text":"","category":"section"},{"location":"api/","page":"API","title":"API","text":"Metida.CompoundSymmetry","category":"page"},{"location":"api/#Metida.CompoundSymmetry","page":"API","title":"Metida.CompoundSymmetry","text":"CompoundSymmetry()\n\n\n\n\n\n","category":"function"},{"location":"api/#Metida.HeterogeneousCompoundSymmetry","page":"API","title":"Metida.HeterogeneousCompoundSymmetry","text":"","category":"section"},{"location":"api/","page":"API","title":"API","text":"Metida.HeterogeneousCompoundSymmetry","category":"page"},{"location":"api/#Metida.HeterogeneousCompoundSymmetry","page":"API","title":"Metida.HeterogeneousCompoundSymmetry","text":"HeterogeneousCompoundSymmetry()\n\n\n\n\n\n","category":"function"},{"location":"api/#StatsBase.dof","page":"API","title":"StatsBase.dof","text":"","category":"section"},{"location":"api/","page":"API","title":"API","text":"StatsBase.dof","category":"page"},{"location":"api/#StatsBase.dof_residual","page":"API","title":"StatsBase.dof_residual","text":"","category":"section"},{"location":"api/","page":"API","title":"API","text":"StatsBase.dof_residual","category":"page"},{"location":"api/#Metida.dof_satter","page":"API","title":"Metida.dof_satter","text":"","category":"section"},{"location":"api/","page":"API","title":"API","text":"Metida.dof_satter","category":"page"},{"location":"api/#Metida.dof_satter","page":"API","title":"Metida.dof_satter","text":"dof_satter(lmm::LMM{T}, l) where T\n\nReturn Satterthwaite approximation for the denominator degrees of freedom, where l is a contrast vector (estimable linear combination of \fβ).    \n\n\n\n\n\n","category":"function"},{"location":"api/#Metida.caic","page":"API","title":"Metida.caic","text":"","category":"section"},{"location":"api/","page":"API","title":"API","text":"Metida.caic","category":"page"},{"location":"api/#Metida.caic","page":"API","title":"Metida.caic","text":"caic(lmm::LMM)\n\n\n\n\n\n","category":"function"},{"location":"api/#Metida.gmatrix","page":"API","title":"Metida.gmatrix","text":"","category":"section"},{"location":"api/","page":"API","title":"API","text":"Metida.gmatrix","category":"page"},{"location":"api/#Metida.gmatrix","page":"API","title":"Metida.gmatrix","text":"gmatrix(lmm::LMM{T}, r::Int) where T\n\n\n\n\n\n","category":"function"},{"location":"api/#Metida.rmatrix","page":"API","title":"Metida.rmatrix","text":"","category":"section"},{"location":"api/","page":"API","title":"API","text":"Metida.rmatrix","category":"page"},{"location":"api/#Metida.rmatrix","page":"API","title":"Metida.rmatrix","text":"rmatrix(lmm::LMM{T}, i::Int) where T\n\n\n\n\n\n","category":"function"},{"location":"api/#Metida.vmatrix!","page":"API","title":"Metida.vmatrix!","text":"","category":"section"},{"location":"api/","page":"API","title":"API","text":"Metida.vmatrix!","category":"page"},{"location":"api/#Metida.vmatrix!","page":"API","title":"Metida.vmatrix!","text":"vmatrix!(V, θ, lmm, i)\n\nUpdate variance-covariance matrix V for i bolock.\n\n\n\n\n\n","category":"function"},{"location":"details/#Details","page":"Details","title":"Details","text":"","category":"section"},{"location":"details/#Model","page":"Details","title":"Model","text":"","category":"section"},{"location":"details/","page":"Details","title":"Details","text":"In matrix notation a mixed effect model can be represented as:","category":"page"},{"location":"details/","page":"Details","title":"Details","text":"y = Xbeta + Zu + epsilon","category":"page"},{"location":"details/#V","page":"Details","title":"V","text":"","category":"section"},{"location":"details/","page":"Details","title":"Details","text":"V_i = Z_iGZ_i+R_i","category":"page"},{"location":"details/#Henderson's-«mixed-model-equations»","page":"Details","title":"Henderson's «mixed model equations»","text":"","category":"section"},{"location":"details/","page":"Details","title":"Details","text":"beginpmatrixXR^-1XXR^-1ZZR^-1XZR^-1Z+G_-1endpmatrix  beginpmatrixwidehatbeta  widehatu endpmatrix= beginpmatrixXR^-1yZR^-1yendpmatrix","category":"page"},{"location":"details/","page":"Details","title":"Details","text":"The solution to the mixed model equations is a maximum likelihood estimate when the distribution of the errors is normal. PROC MIXED in SAS / MIXED SPSS used restricted maximum likelihood (REML) approach by default. REML equation by: Henderson,  1959; Laird et.al. 1982; Jennrich 1986; Lindstrom & Bates, 1988; Gurka et.al 2006.","category":"page"},{"location":"details/#REML","page":"Details","title":"REML","text":"","category":"section"},{"location":"details/","page":"Details","title":"Details","text":"logREML(thetabeta) = -fracN-p2 - frac12sum_i=1^nlogV_i-\n\n-frac12logsum_i=1^nX_iV_i^-1X_i-frac12sum_i=1^n(y_i - X_ibeta)V_i^-1(y_i - X_ibeta)","category":"page"},{"location":"details/#Beta-(β)","page":"Details","title":"Beta (β)","text":"","category":"section"},{"location":"details/","page":"Details","title":"Details","text":"beta = (sum_i=1^n X_iV_i^-1X_i)^-1(sum_i=1^n X_iV_i^-1y_i)","category":"page"},{"location":"details/#F","page":"Details","title":"F","text":"","category":"section"},{"location":"details/","page":"Details","title":"Details","text":"F = fracbetaL(LCL)^-1Lbetarank(LCL)","category":"page"},{"location":"details/#Variance-covariance-matrix-of-β","page":"Details","title":"Variance covariance matrix of β","text":"","category":"section"},{"location":"details/","page":"Details","title":"Details","text":"C = (sum_i=1^n X_iV_i^-1X_i)^-1","category":"page"},{"location":"details/#Sweep","page":"Details","title":"Sweep","text":"","category":"section"},{"location":"details/","page":"Details","title":"Details","text":"Details see: https://github.com/joshday/SweepOperator.jl","category":"page"},{"location":"nlopt/#NLopt","page":"NLopt","title":"NLopt","text":"","category":"section"},{"location":"nlopt/","page":"NLopt","title":"NLopt","text":"Optimization with NLopt.jl.","category":"page"},{"location":"nlopt/","page":"NLopt","title":"NLopt","text":"Install:","category":"page"},{"location":"nlopt/","page":"NLopt","title":"NLopt","text":"using Pkg\nPkg.add(\"MetidaNLopt\")","category":"page"},{"location":"nlopt/","page":"NLopt","title":"NLopt","text":"Using:","category":"page"},{"location":"nlopt/","page":"NLopt","title":"NLopt","text":"using Metida, MetidaNLopt, StatsBase, StatsModels, CSV, DataFrames\ndf = CSV.File(dirname(pathof(Metida))*\"\\\\..\\\\test\\\\csv\\\\df0.csv\") |> DataFrame\nlmm = LMM(@formula(var ~ sequence + period + formulation), df;\nrandom   = VarEffect(@covstr(formulation), CSH),\nrepeated = VarEffect(@covstr(formulation), VC),\nsubject  = :subject)\n\nfit!(lmm; solver = :nlopt)","category":"page"},{"location":"examples/#Examples","page":"Examples","title":"Examples","text":"","category":"section"},{"location":"examples/","page":"Examples","title":"Examples","text":"using Metida, StatsBase, StatsModels, CSV, DataFrames\ndf0 = CSV.File(dirname(pathof(Metida))*\"\\\\..\\\\test\\\\csv\\\\df0.csv\") |> DataFrame\n\n################################################################################\n#                                 EXAMPLE 1\n################################################################################\n#=\nPROC MIXED data=df0;\nCLASSES subject sequence period formulation;\nMODEL  var = sequence period formulation/ DDFM=SATTERTH s;\nRANDOM  formulation/TYPE=CSH SUB=subject G V;\nREPEATED/GRP=formulation SUB=subject R;\nRUN;\nREML: 10.06523862\n=#\n\nlmm = LMM(@formula(var ~ sequence + period + formulation), df0;\nrandom   = VarEffect(@covstr(formulation), CSH),\nrepeated = VarEffect(@covstr(formulation), DIAG),\nsubject  = :subject)\nfit!(lmm)\n\n#=\nLinear Mixed Model: var ~ sequence + period + formulation\nRandom 1:\n   Model: formulation\n   Type: HeterogeneousCompoundSymmetry (3)\n   Coefnames: [\"formulation: 1\", \"formulation: 2\"]\nRepeated:\n   Model: formulation\n   Type: VarianceComponents (2)\n   Coefnames: [\"formulation: 1\", \"formulation: 2\"]\n\nStatus: converged\n\n   -2 logREML: 10.0652\n\n   Fixed effects:\n\nName             Estimate     SE\n(Intercept)      1.57749      0.334543\nsequence: 2      -0.170833    0.384381\nperiod: 2        0.195984     0.117228\nperiod: 3        0.145014     0.109171\nperiod: 4        0.157363     0.117228\nformulation: 2   -0.0791667   0.0903709\n\nRandom effects:\n\n   θ vector: [0.455584, 0.367656, 1.0, 0.143682, 0.205657]\n\nRandom 1   formulation: 1   var   0.207557\nRandom 1   formulation: 2   var   0.135171\nRandom 1   Rho              rho   1.0\nRepeated   formulation: 1   var   0.0206445\nRepeated   formulation: 2   var   0.0422948\n=#\n\n################################################################################\n#                                 EXAMPLE 2\n################################################################################\n#=\nPROC MIXED data=df0;\nCLASSES subject sequence period formulation;\nMODEL  var = sequence period formulation/ DDFM=SATTERTH s;\nRANDOM  formulation/TYPE=VC SUB=subject G V;\nREPEATED/GRP=formulation SUB=subject R;\nRUN;\n\nREML: 16.06148160\n=#\n\nlmm = LMM(\n    @formula(var ~ sequence + period + formulation), df0;\n    random   = VarEffect(@covstr(formulation), SI),\n    repeated = VarEffect(@covstr(formulation), DIAG),\n    subject  = :subject,\n)\nfit!(lmm)\n#=\nLinear Mixed Model: var ~ sequence + period + formulation\nRandom 1:\n   Model: formulation\n   Type: ScaledIdentity (1)\n   Coefnames: [\"formulation: 1\", \"formulation: 2\"]\nRepeated:\n   Model: formulation\n   Type: VarianceComponents (2)\n   Coefnames: [\"formulation: 1\", \"formulation: 2\"]\n\nStatus: converged\n\n   -2 logREML: 16.0615\n\n   Fixed effects:\n\nName             Estimate     SE\n(Intercept)      1.57212      0.305807\nsequence: 2      -0.170833    0.279555\nperiod: 2        0.204087     0.289957\nperiod: 3        0.155769     0.11308\nperiod: 4        0.160015     0.289957\nformulation: 2   -0.0791667   0.279555\n\nRandom effects:\n\n   θ vector: [0.412436, 0.145184, 0.220819]\n\nRandom 1   Var              var   0.170103\nRepeated   formulation: 1   var   0.0210784\nRepeated   formulation: 2   var   0.048761\n=#\n\n\n################################################################################\n#                                 EXAMPLE 3\n################################################################################\n#=\nPROC MIXED data=df0;\nCLASSES subject sequence period formulation;\nMODEL  var = sequence period formulation/ DDFM=SATTERTH s;\nRANDOM  subject/TYPE=VC G V;\nRUN;\n\nREML: 10.86212458\n=#\n\nlmm = LMM(@formula(var ~ sequence + period + formulation), df0;\n    random = VarEffect(@covstr(subject), SI)\n    )\nfit!(lmm)\n#=\nLinear Mixed Model: var ~ sequence + period + formulation\nRandom 1:\n   Model: subject\n   Type: ScaledIdentity (1)\n   Coefnames: [\"subject: 1\", \"subject: 2\", \"subject: 3\", \"subject: 4\", \"subject: 5\"]\nRepeated:\n   Model: nothing\n   Type: ScaledIdentity (1)\n   Coefnames: -\n\nStatus: converged\n\n   -2 logREML: 10.8621\n\n   Fixed effects:\n\nName             Estimate     SE\n(Intercept)      1.61         0.309774\nsequence: 2      -0.170833    0.383959\nperiod: 2        0.144167     0.116706\nperiod: 3        0.08         0.115509\nperiod: 4        0.144167     0.116706\nformulation: 2   -0.0791667   0.0833617\n\nRandom effects:\n\n   θ vector: [0.410574, 0.182636]\n\nRandom 1   Var   var   0.168571\nRepeated   Var   var   0.0333559\n=#\n\n################################################################################\n#                                 EXAMPLE 4\n################################################################################\n#=\nPROC MIXED data=df0;\nCLASSES subject sequence period formulation;\nMODEL  var = sequence period formulation/ DDFM=SATTERTH s;\nRANDOM  period/TYPE=VC G V;\nRANDOM  formulation/TYPE=VC G V;\nRUN;\n\nREML: 25.12948063\n=#\nlmm = LMM(\n    @formula(var ~ sequence + period + formulation), df;\n    random   = [VarEffect(@covstr(period), VC), VarEffect(@covstr(formulation), DIAG)]\n)\nfit!(lmm)\n\n#=\nLinear Mixed Model: var ~ sequence + period + formulation\nRandom 1:\n   Model: period\n   Type: VarianceComponents (4)\n   Coefnames: [\"period: 1\", \"period: 2\", \"period: 3\", \"period: 4\"]\nRandom 2:\n   Model: formulation\n   Type: VarianceComponents (2)\n   Coefnames: [\"formulation: 1\", \"formulation: 2\"]\nRepeated:\n   Model: nothing\n   Type: ScaledIdentity (1)\n   Coefnames: -\n\nStatus: converged\n\n   -2 logREML: 25.1295\n\n   Fixed effects:\n\nName             Estimate     SE\n(Intercept)      1.61         0.249491\nsequence: 2      -0.170833    0.192487\nperiod: 2        0.144167     0.269481\nperiod: 3        0.08         0.266717\nperiod: 4        0.144167     0.269481\nformulation: 2   -0.0791667   0.192487\n\nRandom effects:\n\n   θ vector: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.421717]\n\nRandom 1   period: 1        var   0.0\nRandom 1   period: 2        var   0.0\nRandom 1   period: 3        var   0.0\nRandom 1   period: 4        var   0.0\nRandom 2   formulation: 1   var   0.0\nRandom 2   formulation: 2   var   0.0\nRepeated   Var              var   0.177845\n=#\n\n#EXAMPLE 5\n################################################################################\n#                                 EXAMPLE 5\n################################################################################\n#=\nPROC MIXED data=df0;\nCLASSES subject sequence period formulation;\nMODEL  var = sequence period formulation/ DDFM=SATTERTH s;\nRANDOM  formulation/TYPE=UN(1) SUB=subject G V;\nRUN;\n\nREML: 16.24111264\n=#\n\nlmm = LMM(@formula(var ~ sequence + period + formulation), df0;\n    random  = VarEffect(@covstr(formulation), DIAG),\n    subject = :subject)\nfit!(lmm)\n\n#=\nLinear Mixed Model: var ~ sequence + period + formulation\nRandom 1:\n   Model: formulation\n   Type: VarianceComponents (2)\n   Coefnames: [\"formulation: 1\", \"formulation: 2\"]\nRepeated:\n   Model: nothing\n   Type: ScaledIdentity (1)\n   Coefnames: -\n\nStatus: converged\n\n   -2 logREML: 16.2411\n\n   Fixed effects:\n\nName             Estimate     SE\n(Intercept)      1.61         0.334718\nsequence: 2      -0.170833    0.277378\nperiod: 2        0.144167     0.289463\nperiod: 3        0.08         0.117047\nperiod: 4        0.144167     0.289463\nformulation: 2   -0.0791667   0.277378\n\nRandom effects:\n\n   θ vector: [0.447322, 0.367367, 0.185068]\n\nRandom 1   formulation: 1   var   0.200097\nRandom 1   formulation: 2   var   0.134959\nRepeated   Var              var   0.0342502\n=#\n\n#EXAMPLE 6\n################################################################################\n#                                 EXAMPLE 6\n################################################################################\n\nusing MixedModels\n\nfm = @formula(var~sequence+period+formulation + (0+formulation|subject))\nmm = fit(MixedModel, fm, df, REML=true)\n\n#=\nLinear mixed model fit by REML\n var ~ 1 + sequence + period + formulation + (0 + formulation | subject)\n REML criterion at convergence: 10.314822479361407\n\nVariance components:\n             Column      Variance Std.Dev.   Corr.\nsubject  formulation: 1  0.2027892 0.450321\n         formulation: 2  0.1383032 0.371891 +1.00\nResidual                 0.0316615 0.177937\n Number of obs: 20; levels of grouping factors: 5\n\n  Fixed-effects parameters:\n───────────────────────────────────────────────────────\n                     Coef.  Std. Error      z  Pr(>|z|)\n───────────────────────────────────────────────────────\n(Intercept)      1.61        0.335375    4.80    <1e-5\nsequence: 2     -0.170833    0.383975   -0.44    0.6564\nperiod: 2        0.144167    0.119206    1.21    0.2265\nperiod: 3        0.08        0.112537    0.71    0.4772\nperiod: 4        0.144167    0.119206    1.21    0.2265\nformulation: 2  -0.0791667   0.0887562  -0.89    0.3724\n───────────────────────────────────────────────────────\n=#\n\nlmm = LMM(@formula(var~sequence+period+formulation), df;\nrandom = VarEffect(Metida.@covstr(formulation), CSH),\nrepeated = VarEffect(Metida.@covstr(formulation), SI),\nsubject = :subject)\nMetida.fit!(lmm)\n\n#=\nLinear Mixed Model: var ~ sequence + period + formulation\nRandom 1:\n   Model: formulation\n   Type: CSH (3)\n   Coefnames: [\"formulation: 1\", \"formulation: 2\"]\nRepeated:\n   Model: formulation\n   Type: SI (1)\n   Coefnames: [\"formulation: 1\", \"formulation: 2\"]\n\nStatus: converged\n\n   -2 logREML: 10.3148\n\n   Fixed effects:\n\nName             Estimate     SE          z           Pr(>|z|)\n(Intercept)      1.61         0.335376    4.80058     1.58204e-6\nsequence: 2      -0.170833    0.383976    -0.444906   0.656388\nperiod: 2        0.144167     0.119205    1.2094      0.226511\nperiod: 3        0.08         0.112537    0.710877    0.47716\nperiod: 4        0.144167     0.119205    1.2094      0.226511\nformulation: 2   -0.0791667   0.0887561   -0.891957   0.372416\n\nRandom effects:\n\n   θ vector: [0.450323, 0.371893, 1.0, 0.177937]\n\nRandom 1   formulation: 1   var   0.202791\nRandom 1   formulation: 2   var   0.138304\nRandom 1   Rho              rho   1.0\nRepeated   Var              var   0.0316616\n=#\n\n################################################################################\n","category":"page"},{"location":"validation/#Validation","page":"Validation","title":"Validation","text":"","category":"section"},{"location":"validation/#REML-result-table","page":"Validation","title":"REML result table","text":"","category":"section"},{"location":"validation/","page":"Validation","title":"Validation","text":"Model DataSet REML  Metida REML SPSS\n1 sleepstudy.csv 1729.4925602367025 1729.492560\n2 sleepstudy.csv 1904.3265170722132 1904.327\n3 sleepstudy.csv 1772.0953251997046 1772.095\n4 sleepstudy.csv 1730.1895427398322 1730.189543\n5 pastes.csv 246.99074585348623 246.990746\n6 pastes.csv 246.81895071012508 246.818951\n7 penicillin.csv 330.86058899109184 330.860589","category":"page"},{"location":"validation/#sleepstudy.csv","page":"Validation","title":"sleepstudy.csv","text":"","category":"section"},{"location":"validation/#Model-1","page":"Validation","title":"Model 1","text":"","category":"section"},{"location":"validation/","page":"Validation","title":"Validation","text":"lmm = Metida.LMM(@formula(Reaction~Days), df;\n  random = Metida.VarEffect(Metida.SI),\n  subject = :Subject\n  )\n  Metida.fit!(lmm)","category":"page"},{"location":"validation/","page":"Validation","title":"Validation","text":"","category":"page"},{"location":"validation/#Model-2","page":"Validation","title":"Model 2","text":"","category":"section"},{"location":"validation/","page":"Validation","title":"Validation","text":"lmm = Metida.LMM(@formula(Reaction~1), df;\n  random = Metida.VarEffect(Metida.@covstr(Days), Metida.CS),\n  subject = :Subject\n  )\n  Metida.fit!(lmm)","category":"page"},{"location":"validation/","page":"Validation","title":"Validation","text":"","category":"page"},{"location":"validation/#Model-3","page":"Validation","title":"Model 3","text":"","category":"section"},{"location":"validation/","page":"Validation","title":"Validation","text":"lmm = Metida.LMM(@formula(Reaction~1), df;\n  random = Metida.VarEffect(Metida.@covstr(Days), Metida.CSH, subj = :Subject)\n  )\n  Metida.fit!(lmm)","category":"page"},{"location":"validation/","page":"Validation","title":"Validation","text":"","category":"page"},{"location":"validation/#Model-4","page":"Validation","title":"Model 4","text":"","category":"section"},{"location":"validation/","page":"Validation","title":"Validation","text":"lmm = Metida.LMM(@formula(Reaction~1), df;\n  random = Metida.VarEffect(Metida.@covstr(Days), Metida.ARH, subj = :Subject)\n  )\n  Metida.fit!(lmm)","category":"page"},{"location":"validation/","page":"Validation","title":"Validation","text":"","category":"page"},{"location":"validation/#pastes.csv","page":"Validation","title":"pastes.csv","text":"","category":"section"},{"location":"validation/#Model-5","page":"Validation","title":"Model 5","text":"","category":"section"},{"location":"validation/","page":"Validation","title":"Validation","text":"lmm = Metida.LMM(@formula(strength~1), df;\nrandom = [Metida.VarEffect(Metida.SI, subj = :batch), Metida.VarEffect(Metida.SI, subj = [:batch,  :cask])]\n)\nMetida.fit!(lmm)","category":"page"},{"location":"validation/","page":"Validation","title":"Validation","text":"","category":"page"},{"location":"validation/#Model-6","page":"Validation","title":"Model 6","text":"","category":"section"},{"location":"validation/","page":"Validation","title":"Validation","text":"lmm = Metida.LMM(@formula(strength~1), df;\nrandom = Metida.VarEffect(Metida.@covstr(cask), Metida.ARMA, subj = :batch),\n)\nMetida.fit!(lmm)","category":"page"},{"location":"validation/","page":"Validation","title":"Validation","text":"","category":"page"},{"location":"validation/#penicillin.csv","page":"Validation","title":"penicillin.csv","text":"","category":"section"},{"location":"validation/#Model-7","page":"Validation","title":"Model 7","text":"","category":"section"},{"location":"validation/","page":"Validation","title":"Validation","text":"lmm = Metida.LMM(@formula(diameter~1), df;\nrandom = [Metida.VarEffect(Metida.SI, subj = :plate), Metida.VarEffect(Metida.SI, subj = :sample)]\n)\nMetida.fit!(lmm)","category":"page"},{"location":"validation/","page":"Validation","title":"Validation","text":"","category":"page"},{"location":"validation/#Reference-dataset","page":"Validation","title":"Reference dataset","text":"","category":"section"},{"location":"validation/","page":"Validation","title":"Validation","text":"Schütz, H., Labes, D., Tomashevskiy, M. et al. Reference Datasets for Studies in a Replicate Design Intended for Average Bioequivalence with Expanding Limits. AAPS J 22, 44 (2020). https://doi.org/10.1208/s12248-020-0427-6\nGregory Belenky, Nancy J. Wesensten, David R. Thorne, Maria L. Thomas, Helen C. Sing, Daniel P. Redmond, Michael B. Russo and Thomas J. Balkin (2003) Patterns of performance degradation and restoration during sleep restriction and subsequent recovery: a sleep dose-response study. Journal of Sleep Research 12, 1–12.\nO.L. Davies and P.L. Goldsmith (eds), Statistical Methods in Research and Production, 4th ed., Oliver and Boyd, (1972), section 6.6\nO.L. Davies and P.L. Goldsmith (eds), Statistical Methods in Research and Production, 4th ed., Oliver and Boyd, (1972), section 6.5","category":"page"},{"location":"validation/","page":"Validation","title":"Validation","text":"https://vincentarelbundock.github.io/Rdatasets/datasets.html","category":"page"},{"location":"validation/","page":"Validation","title":"Validation","text":"Stock, J.H. and Watson, M.W. (2007). Introduction to Econometrics, 2nd ed. Boston: Addison Wesley. Anglin, P.M. and R. Gencay (1996) “Semiparametric estimation of a hedonic price function”, Journal of Applied Econometrics, 11(6), 633-648. Anglin, P., and Gencay, R. (1996). Semiparametric Estimation of a Hedonic Price Function. Journal of Applied Econometrics, 11, 633–648.","category":"page"},{"location":"validation/","page":"Validation","title":"Validation","text":"Verbeek, M. (2004). A Guide to Modern Econometrics, 2nd ed. Chichester, UK: John Wiley. O'Brien, R. G., and Kaiser, M. K. (1985) MANOVA method for analyzing repeated measures designs: An extensive primer. Psychological Bulletin 97, 316–333, Table 7.","category":"page"},{"location":"options/#Options","page":"Options","title":"Options","text":"","category":"section"},{"location":"options/#Initial-values","page":"Options","title":"Initial values","text":"","category":"section"},{"location":"options/#Link-functions","page":"Options","title":"Link functions","text":"","category":"section"},{"location":"options/#Linesearch","page":"Options","title":"Linesearch","text":"","category":"section"},{"location":"options/#Optimization-options","page":"Options","title":"Optimization options","text":"","category":"section"},{"location":"options/#SVD-values","page":"Options","title":"SVD values","text":"","category":"section"},{"location":"ref/#Citation-and-Reference","page":"Citation & Reference","title":"Citation & Reference","text":"","category":"section"},{"location":"ref/#Sweep-algorithm","page":"Citation & Reference","title":"Sweep algorithm","text":"","category":"section"},{"location":"ref/","page":"Citation & Reference","title":"Citation & Reference","text":"Sweep based on SweepOperator.jl. Thanks to @joshday and @Hua-Zhou.\nhttp://hua-zhou.github.io/teaching/biostatm280-2019spring/slides/12-sweep/sweep.html","category":"page"},{"location":"ref/","page":"Citation & Reference","title":"Citation & Reference","text":"More:","category":"page"},{"location":"ref/","page":"Citation & Reference","title":"Citation & Reference","text":"Section 7.4-7.6 of Numerical Analysis for Statisticians by Kenneth Lange (2010).\nThe paper A tutorial on the SWEEP operator by James H. Goodnight (1979).","category":"page"},{"location":"ref/#REML-and-Parameter-estimation","page":"Citation & Reference","title":"REML & Parameter estimation","text":"","category":"section"},{"location":"ref/","page":"Citation & Reference","title":"Citation & Reference","text":"Henderson, C. R., et al. “The Estimation of Environmental and Genetic Trends from Records Subject to Culling.” Biometrics, vol. 15, no. 2, 1959, pp. 192–218. JSTOR, www.jstor.org/stable/2527669.\nLaird, Nan M., and James H. Ware. “Random-Effects Models for Longitudinal Data.” Biometrics, vol. 38, no. 4, 1982, pp. 963–974. JSTOR, www.jstor.org/stable/2529876.\nLindstrom & J.; Bates, M. (1988). Newton—Raphson and EM Algorithms for Linear Mixed-Effects Models for Repeated-Measures Data. Journal of the American Statistical Association. 83. 1014. 10.1080/01621459.1988.10478693.\nGurka, Matthew. (2006). Selecting the Best Linear Mixed Model under REML. The American Statistician. 60. 19-26. 10.1198/000313006X90396.\nSang Hong Lee, Julius H.J. van der Werf. An efficient variance component approach implementing an average information REML suitable for combined LD and linkage mapping with a general complex pedigree. Genetics Selection Evolution, BioMed Central, 2006, 38 (1), pp.25-43. ⟨hal-00894558⟩\nF.N. Gumedze, T.T. Dunne, Parameter estimation and inference in the linear mixed model, Linear Algebra and its Applications, Volume 435, Issue 8, 2011, Pages 1920-1944, ISSN 0024-3795, https://doi.org/10.1016/j.laa.2011.04.015. (http://www.sciencedirect.com/science/article/pii/S002437951100320X)","category":"page"},{"location":"ref/#AI-algorithm","page":"Citation & Reference","title":"AI algorithm","text":"","category":"section"},{"location":"ref/","page":"Citation & Reference","title":"Citation & Reference","text":"D.L. Johnson, R. Thompson, Restricted Maximum Likelihood Estimation of Variance Components for Univariate Animal Models Using Sparse Matrix Techniques and Average Information, Journal of Dairy Science, Volume 78, Issue 2, 1995, Pages 449-456, ISSN 0022-0302, https://doi.org/10.3168/jds.S0022-0302(95)76654-1. (http://www.sciencedirect.com/science/article/pii/S0022030295766541)\nMishchenko, Kateryna & Holmgren, Sverker & Rönnegård, Lars. (2007). Newton-type Methods for REML Estimation in Genetic Analysis of Quantitative Traits. Journal of Computational Methods in Science and Engineering. 8. 10.3233/JCM-2008-81-203.\nMatilainen K, Mäntysaari EA, Lidauer MH, Strandén I, Thompson R. Employing a Monte Carlo algorithm in Newton-type methods for restricted maximum likelihood estimation of genetic parameters. PLoS One. 2013;8(12):e80821. Published 2013 Dec 10. doi:10.1371/journal.pone.0080821","category":"page"},{"location":"ref/#Covariance-structures","page":"Citation & Reference","title":"Covariance structures","text":"","category":"section"},{"location":"ref/","page":"Citation & Reference","title":"Citation & Reference","text":"Wolfinger, Russ. (1993). Covariance structure selection in general mixed models. Communications in Statistics-simulation and Computation - COMMUN STATIST-SIMULAT COMPUT. 22. 1079-1106. 10.1080/03610919308813143.\nLittell, Ramon & Pendergast, Jane & Natarajan, Ranjini. (2000). Modelling covariance structure in the analysis of repeated measures data. Statistics in Medicine. 19. 1793-1819. 10.1002/1097-0258(20000715)19:13%3C1793::AID-SIM482%3E3.0.CO;2-Q.\nQUINTAL, SILVANA SILVA RED, VIANA, ALEXANDRE PIO, CAMPOS, BIANCA MACHADO, VIVAS, MARCELO, & AMARAL JÚNIOR, ANTONIO TEIXEIRA DO. (2017). ANALYSIS OF STRUCTURES OF COVARIANCE AND REPEATABILITY IN GUAVA SEGREGANTING POPULATION. Revista Caatinga, 30(4), 885-891. https://doi.org/10.1590/1983-21252017v30n408rc\nMcNeish, D., Harring, J. Covariance pattern mixture models: Eliminating random effects to improve convergence and performance. Behav Res 52, 947–979 (2020). https://doi.org/10.3758/s13428-019-01292-4","category":"page"},{"location":"ref/#And-more","page":"Citation & Reference","title":"And more","text":"","category":"section"},{"location":"ref/","page":"Citation & Reference","title":"Citation & Reference","text":"Giesbrecht, F. G., and Burns, J. C. (1985), \"Two-Stage Analysis Based on a Mixed Model: Large-sample Asymptotic Theory and Small-Sample Simulation Results,\" Biometrics, 41, 853-862.\nJennrich, R., & Schluchter, M. (1986). Unbalanced Repeated-Measures Models with Structured Covariance Matrices. Biometrics, 42(4), 805-820. doi:10.2307/2530695\nFletcher, Roger (1987), Practical methods of optimization (2nd ed.), New York: John Wiley & Sons, ISBN 978-0-471-91547-8\nWolfinger et al., (1994) Computing gaussian likelihoods and their derivatives for general linear mixed models doi: 10.1137/0915079\nHrong-Tai Fai & Cornelius (1996) Approximate F-tests of multiple degree of freedom hypotheses in generalized least squares analyses of unbalanced split-plot experiments, Journal of Statistical Computation and Simulation, 54:4, 363-378, DOI: 10.1080/00949659608811740\nSchaalje GB, McBride JB, Fellingham GW. Adequacy of approximations to distributions of test statistics in complex mixed linear models. J Agric Biol Environ Stat. 2002;7:512–24.\nWright, Stephen, and Jorge Nocedal (2006) \"Numerical optimization.\" Springer\nVan Peer, A. (2010), Variability and Impact on Design of Bioequivalence Studies. Basic & Clinical Pharmacology & Toxicology, 106: 146-153. doi:10.1111/j.1742-7843.2009.00485.x","category":"page"},{"location":"ref/#Julia-packages","page":"Citation & Reference","title":"Julia packages","text":"","category":"section"},{"location":"ref/","page":"Citation & Reference","title":"Citation & Reference","text":"Revels, Jarrett & Lubin, Miles & Papamarkou, Theodore. (2016). Forward-Mode Automatic Differentiation in Julia.\nMogensen et al., (2018). Optim: A mathematical optimization package for Julia. Journal of Open Source Software, 3(24), 615,doi: 10.21105/joss.00615","category":"page"},{"location":"ref/#CuSolver-and-CuBLAS","page":"Citation & Reference","title":"CuSolver & CuBLAS","text":"","category":"section"},{"location":"ref/","page":"Citation & Reference","title":"Citation & Reference","text":"https://docs.nvidia.com/cuda/cusolver/index.html\nhttps://docs.nvidia.com/cuda/cublas/index.htm","category":"page"},{"location":"bench/#Benchmark","page":"Benchmark","title":"Benchmark","text":"","category":"section"},{"location":"#Metida","page":"Home","title":"Metida","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"CurrentModule = Metida","category":"page"},{"location":"#Mixed-Models","page":"Home","title":"Mixed Models","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Metida.jl is a Julia package for fitting mixed-effects models with flexible covariance structure.","category":"page"},{"location":"","page":"Home","title":"Home","text":"Implemented covariance structures:","category":"page"},{"location":"","page":"Home","title":"Home","text":"Scaled Identity (SI)\nDiagonal (DIAG)\nAutoregressive (AR)\nHeterogeneous Autoregressive (ARH)\nCompound Symmetry (CS)\nHeterogeneous Compound Symmetry (CSH)\nAutoregressive Moving Average (ARMA)","category":"page"},{"location":"#Usage","page":"Home","title":"Usage","text":"","category":"section"},{"location":"#Model-construction","page":"Home","title":"Model construction","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"LMM(model, data; subject = nothing,  random = nothing, repeated = nothing)","category":"page"},{"location":"","page":"Home","title":"Home","text":"where:","category":"page"},{"location":"","page":"Home","title":"Home","text":"model is a fixed-effect model (@formula), example: @formula(var ~ sequence + period + formulation)\nrandom vector of random effects or single random effect. Effect can be declared like this: VarEffect(@covstr(formulation), CSH). @covstr is a effect model: @covstr(formulation). CSH is a  CovarianceType structure. Premade constants: SI, DIAG, AR, ARH, CS, CSH, ARMA.\nrepeated is a repeated effect (only single).\nsubject is a block-diagonal factor.","category":"page"},{"location":"#Fitting","page":"Home","title":"Fitting","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"fit!(lmm::LMM{T};\n    solver::Symbol = :default,\n    verbose = :auto,\n    varlinkf = :exp,\n    rholinkf = :sigm,\n    aifirst::Bool = false,\n    g_tol::Float64 = 1e-12,\n    x_tol::Float64 = 1e-12,\n    f_tol::Float64 = 1e-12,\n    hcalck::Bool   = true,\n    init = nothing,\n    io::IO = stdout)","category":"page"},{"location":"","page":"Home","title":"Home","text":"where:","category":"page"},{"location":"","page":"Home","title":"Home","text":"solver - :default / :nlopt / :cuda\nverbose - :auto / 1 / 2 / 3\nvarlinkf - not implemented\nrholinkf - not implemented\ng_tol - absolute tolerance in the gradient\nx_tol - absolute tolerance of theta vector\nf_tol - absolute tolerance in changes of the REML\nhcalck - calculate REML Hessian\ninit - initial theta values\nio - uotput IO","category":"page"},{"location":"","page":"Home","title":"Home","text":"Pages = [\n        \"examples.md\",\n        \"details.md\",\n        \"api.md\"]\nDepth = 3","category":"page"},{"location":"","page":"Home","title":"Home","text":"See also:","category":"page"},{"location":"","page":"Home","title":"Home","text":"MixedModels.jl","category":"page"}]
}
