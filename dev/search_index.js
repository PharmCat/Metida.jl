var documenterSearchIndex = {"docs":
[{"location":"#Metida","page":"Home","title":"Metida","text":"","category":"section"},{"location":"#Mixed-Models","page":"Home","title":"Mixed Models","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Metida.jl is a Julia package for fitting mixed-effects models with flexible covariance structure. At this moment package is in early development stage.","category":"page"},{"location":"","page":"Home","title":"Home","text":"Main goal to make reproducible output corresponding to SAS/SPSS.","category":"page"},{"location":"","page":"Home","title":"Home","text":"Now implemented covariance structures:","category":"page"},{"location":"","page":"Home","title":"Home","text":"Scaled Identity (SI)\nVariance Components / Diagonal (VC)\nAutoregressive (AR)\nHeterogeneous Autoregressive (ARH)\nHeterogeneous Compound Symmetry (CSH)","category":"page"},{"location":"","page":"Home","title":"Home","text":"Usage:","category":"page"},{"location":"","page":"Home","title":"Home","text":"LMM(model, data; subject = nothing,  random = nothing, repeated = nothing)","category":"page"},{"location":"","page":"Home","title":"Home","text":"where","category":"page"},{"location":"","page":"Home","title":"Home","text":"model is a fixed-effect model (@formula), example: @formula(var ~ sequence + period + formulation)","category":"page"},{"location":"","page":"Home","title":"Home","text":"random vector of random effects or single random effect. Effect can be declared like this: VarEffect(@covstr(formulation), CSH). @covstr is a effect model: @covstr(formulation). CSH is a  CovarianceType structure. Premade constants: SI, VC, AR, ARH, CSH.","category":"page"},{"location":"","page":"Home","title":"Home","text":"repeated is a repeated effect (only single).","category":"page"},{"location":"","page":"Home","title":"Home","text":"subject is a block-diagonal factor.","category":"page"},{"location":"","page":"Home","title":"Home","text":"Examples:","category":"page"},{"location":"","page":"Home","title":"Home","text":"using Metida, StatsBase, StatsModels, CSV, DataFrames\ndf = CSV.File(dirname(pathof(Metida))*\"\\\\..\\\\test\\\\csv\\\\df0.csv\") |> DataFrame\n\n# EXAMPLE 1\n################################################################################\n################################################################################\n################################################################################\n#=\nPROC MIXED data=df0;\nCLASSES subject sequence period formulation;\nMODEL  var = sequence period formulation/ DDFM=SATTERTH s;\nRANDOM  formulation/TYPE=CSH SUB=subject G V;\nREPEATED/GRP=formulation SUB=subject R;\nRUN;\n\nREML: 10.06523862\n=#\n\nlmm = LMM(@formula(var ~ sequence + period + formulation), df;\nrandom   = VarEffect(@covstr(formulation), CSH),\nrepeated = VarEffect(@covstr(formulation), VC),\nsubject  = :subject)\n\nfit!(lmm)\n#=\nLinear Mixed Model: var ~ sequence + period + formulation\nRandom 1:\n   Model: formulation\n   Type: HeterogeneousCompoundSymmetry (3)\n   Coefnames: [\"formulation: 1\", \"formulation: 2\"]\nRepeated:\n   Model: formulation\n   Type: VarianceComponents (2)\n   Coefnames: [\"formulation: 1\", \"formulation: 2\"]\n\nStatus: converged\n\n   -2 logREML: 10.0652\n\n   Fixed effects:\n\nName             Estimate     SE\n(Intercept)      1.57749      0.334543\nsequence: 2      -0.170833    0.384381\nperiod: 2        0.195984     0.117228\nperiod: 3        0.145014     0.109171\nperiod: 4        0.157363     0.117228\nformulation: 2   -0.0791667   0.0903709\n\nRandom effects:\n\n   θ vector: [0.455584, 0.367656, 1.0, 0.143682, 0.205657]\n\nRandom 1   formulation: 1   var   0.207557\nRandom 1   formulation: 2   var   0.135171\nRandom 1   Rho              rho   1.0\nRepeated   formulation: 1   var   0.0206445\nRepeated   formulation: 2   var   0.0422948\n=#\n\n# EXAMPLE 2\n################################################################################\n################################################################################\n################################################################################\n#=\nPROC MIXED data=df0;\nCLASSES subject sequence period formulation;\nMODEL  var = sequence period formulation/ DDFM=SATTERTH s;\nRANDOM  formulation/TYPE=VC SUB=subject G V;\nREPEATED/GRP=formulation SUB=subject R;\nRUN;\n\nREML: 16.06148160\n=#\n\nlmm = LMM(\n    @formula(var ~ sequence + period + formulation), df;\n    random   = VarEffect(@covstr(formulation), SI),\n    repeated = VarEffect(@covstr(formulation), VC),\n    subject  = :subject,\n)\nfit!(lmm)\n#=\nLinear Mixed Model: var ~ sequence + period + formulation\nRandom 1:\n   Model: formulation\n   Type: ScaledIdentity (1)\n   Coefnames: [\"formulation: 1\", \"formulation: 2\"]\nRepeated:\n   Model: formulation\n   Type: VarianceComponents (2)\n   Coefnames: [\"formulation: 1\", \"formulation: 2\"]\n\nStatus: converged\n\n   -2 logREML: 16.0615\n\n   Fixed effects:\n\nName             Estimate     SE\n(Intercept)      1.57212      0.305807\nsequence: 2      -0.170833    0.279555\nperiod: 2        0.204087     0.289957\nperiod: 3        0.155769     0.11308\nperiod: 4        0.160015     0.289957\nformulation: 2   -0.0791667   0.279555\n\nRandom effects:\n\n   θ vector: [0.412436, 0.145184, 0.220819]\n\nRandom 1   Var              var   0.170103\nRepeated   formulation: 1   var   0.0210784\nRepeated   formulation: 2   var   0.048761\n=#\n\n#EXAMPLE 3\n################################################################################\n################################################################################\n################################################################################\n#=\nPROC MIXED data=df0;\nCLASSES subject sequence period formulation;\nMODEL  var = sequence period formulation/ DDFM=SATTERTH s;\nRANDOM  subject/TYPE=VC G V;\nRUN;\n\nREML: 10.86212458\n=#\n\nlmm = LMM(@formula(var ~ sequence + period + formulation), df;\n    random = VarEffect(@covstr(subject), SI)\n    )\nfit!(lmm)\n#=\nLinear Mixed Model: var ~ sequence + period + formulation\nRandom 1:\n   Model: subject\n   Type: ScaledIdentity (1)\n   Coefnames: [\"subject: 1\", \"subject: 2\", \"subject: 3\", \"subject: 4\", \"subject: 5\"]\nRepeated:\n   Model: nothing\n   Type: ScaledIdentity (1)\n   Coefnames: -\n\nStatus: converged\n\n   -2 logREML: 10.8621\n\n   Fixed effects:\n\nName             Estimate     SE\n(Intercept)      1.61         0.309774\nsequence: 2      -0.170833    0.383959\nperiod: 2        0.144167     0.116706\nperiod: 3        0.08         0.115509\nperiod: 4        0.144167     0.116706\nformulation: 2   -0.0791667   0.0833617\n\nRandom effects:\n\n   θ vector: [0.410574, 0.182636]\n\nRandom 1   Var   var   0.168571\nRepeated   Var   var   0.0333559\n=#\n\n#EXAMPLE 4\n################################################################################\n################################################################################\n################################################################################\n#=\nPROC MIXED data=df0;\nCLASSES subject sequence period formulation;\nMODEL  var = sequence period formulation/ DDFM=SATTERTH s;\nRANDOM  period/TYPE=VC G V;\nRANDOM  formulation/TYPE=VC G V;\nRUN;\n\nREML: 25.12948063\n=#\nlmm = LMM(\n    @formula(var ~ sequence + period + formulation), df;\n    random   = [VarEffect(@covstr(period), VC), VarEffect(@covstr(formulation), VC)]\n)\nfit!(lmm)\n\n#=\nLinear Mixed Model: var ~ sequence + period + formulation\nRandom 1:\n   Model: period\n   Type: VarianceComponents (4)\n   Coefnames: [\"period: 1\", \"period: 2\", \"period: 3\", \"period: 4\"]\nRandom 2:\n   Model: formulation\n   Type: VarianceComponents (2)\n   Coefnames: [\"formulation: 1\", \"formulation: 2\"]\nRepeated:\n   Model: nothing\n   Type: ScaledIdentity (1)\n   Coefnames: -\n\nStatus: converged\n\n   -2 logREML: 25.1295\n\n   Fixed effects:\n\nName             Estimate     SE\n(Intercept)      1.61         0.249491\nsequence: 2      -0.170833    0.192487\nperiod: 2        0.144167     0.269481\nperiod: 3        0.08         0.266717\nperiod: 4        0.144167     0.269481\nformulation: 2   -0.0791667   0.192487\n\nRandom effects:\n\n   θ vector: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.421717]\n\nRandom 1   period: 1        var   0.0\nRandom 1   period: 2        var   0.0\nRandom 1   period: 3        var   0.0\nRandom 1   period: 4        var   0.0\nRandom 2   formulation: 1   var   0.0\nRandom 2   formulation: 2   var   0.0\nRepeated   Var              var   0.177845\n=#\n\n#EXAMPLE 5\n################################################################################\n################################################################################\n################################################################################\n#=\nPROC MIXED data=df0;\nCLASSES subject sequence period formulation;\nMODEL  var = sequence period formulation/ DDFM=SATTERTH s;\nRANDOM  formulation/TYPE=UN(1) SUB=subject G V;\nRUN;\n\nREML: 16.24111264\n=#\n\nlmm = LMM(@formula(var ~ sequence + period + formulation), df;\n    random  = VarEffect(@covstr(formulation), VC),\n    subject = :subject)\nfit!(lmm)\n\n#=\nLinear Mixed Model: var ~ sequence + period + formulation\nRandom 1:\n   Model: formulation\n   Type: VarianceComponents (2)\n   Coefnames: [\"formulation: 1\", \"formulation: 2\"]\nRepeated:\n   Model: nothing\n   Type: ScaledIdentity (1)\n   Coefnames: -\n\nStatus: converged\n\n   -2 logREML: 16.2411\n\n   Fixed effects:\n\nName             Estimate     SE\n(Intercept)      1.61         0.334718\nsequence: 2      -0.170833    0.277378\nperiod: 2        0.144167     0.289463\nperiod: 3        0.08         0.117047\nperiod: 4        0.144167     0.289463\nformulation: 2   -0.0791667   0.277378\n\nRandom effects:\n\n   θ vector: [0.447322, 0.367367, 0.185068]\n\nRandom 1   formulation: 1   var   0.200097\nRandom 1   formulation: 2   var   0.134959\nRepeated   Var              var   0.0342502\n=#\n################################################################################\n","category":"page"}]
}
