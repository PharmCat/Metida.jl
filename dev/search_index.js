var documenterSearchIndex = {"docs":
[{"location":"api/#API","page":"API","title":"API","text":"","category":"section"},{"location":"api/#Metida.lmm","page":"API","title":"Metida.lmm","text":"","category":"section"},{"location":"api/","page":"API","title":"API","text":"Metida.lmm","category":"page"},{"location":"details/#Details","page":"Details","title":"Details","text":"","category":"section"},{"location":"details/#V","page":"Details","title":"V","text":"","category":"section"},{"location":"details/","page":"Details","title":"Details","text":"V_i = Z_iGZ_i+R_i","category":"page"},{"location":"details/#REML","page":"Details","title":"REML","text":"","category":"section"},{"location":"details/","page":"Details","title":"Details","text":"logREML(thetabeta) = -fracN-p2 - frac12sum_i=1^nlogV_i-\n\n-frac12logsum_i=1^nX_iV_i^-1X_i-frac12sum_i=1^n(y_i - X_ibeta)V_i^-1(y_i - X_ibeta)","category":"page"},{"location":"details/#Beta","page":"Details","title":"Beta","text":"","category":"section"},{"location":"details/","page":"Details","title":"Details","text":"beta = (sum_i=1^n X_iV_i^-1X_i)^-1(sum_i=1^n X_iV_i^-1y_i)","category":"page"},{"location":"details/#Sweep","page":"Details","title":"Sweep","text":"","category":"section"},{"location":"details/","page":"Details","title":"Details","text":"Details see: https://github.com/joshday/SweepOperator.jl","category":"page"},{"location":"examples/#Examples","page":"Examples","title":"Examples","text":"","category":"section"},{"location":"examples/","page":"Examples","title":"Examples","text":"using Metida, StatsBase, StatsModels, CSV, DataFrames\ndf = CSV.File(dirname(pathof(Metida))*\"\\\\..\\\\test\\\\csv\\\\df0.csv\") |> DataFrame\n\n# EXAMPLE 1\n################################################################################\n################################################################################\n################################################################################\n#=\nPROC MIXED data=df0;\nCLASSES subject sequence period formulation;\nMODEL  var = sequence period formulation/ DDFM=SATTERTH s;\nRANDOM  formulation/TYPE=CSH SUB=subject G V;\nREPEATED/GRP=formulation SUB=subject R;\nRUN;\n\nREML: 10.06523862\n=#\n\nlmm = LMM(@formula(var ~ sequence + period + formulation), df;\nrandom   = VarEffect(@covstr(formulation), CSH),\nrepeated = VarEffect(@covstr(formulation), VC),\nsubject  = :subject)\n\nfit!(lmm)\n#=\nLinear Mixed Model: var ~ sequence + period + formulation\nRandom 1:\n   Model: formulation\n   Type: HeterogeneousCompoundSymmetry (3)\n   Coefnames: [\"formulation: 1\", \"formulation: 2\"]\nRepeated:\n   Model: formulation\n   Type: VarianceComponents (2)\n   Coefnames: [\"formulation: 1\", \"formulation: 2\"]\n\nStatus: converged\n\n   -2 logREML: 10.0652\n\n   Fixed effects:\n\nName             Estimate     SE\n(Intercept)      1.57749      0.334543\nsequence: 2      -0.170833    0.384381\nperiod: 2        0.195984     0.117228\nperiod: 3        0.145014     0.109171\nperiod: 4        0.157363     0.117228\nformulation: 2   -0.0791667   0.0903709\n\nRandom effects:\n\n   θ vector: [0.455584, 0.367656, 1.0, 0.143682, 0.205657]\n\nRandom 1   formulation: 1   var   0.207557\nRandom 1   formulation: 2   var   0.135171\nRandom 1   Rho              rho   1.0\nRepeated   formulation: 1   var   0.0206445\nRepeated   formulation: 2   var   0.0422948\n=#\n\n# EXAMPLE 2\n################################################################################\n################################################################################\n################################################################################\n#=\nPROC MIXED data=df0;\nCLASSES subject sequence period formulation;\nMODEL  var = sequence period formulation/ DDFM=SATTERTH s;\nRANDOM  formulation/TYPE=VC SUB=subject G V;\nREPEATED/GRP=formulation SUB=subject R;\nRUN;\n\nREML: 16.06148160\n=#\n\nlmm = LMM(\n    @formula(var ~ sequence + period + formulation), df;\n    random   = VarEffect(@covstr(formulation), SI),\n    repeated = VarEffect(@covstr(formulation), VC),\n    subject  = :subject,\n)\nfit!(lmm)\n#=\nLinear Mixed Model: var ~ sequence + period + formulation\nRandom 1:\n   Model: formulation\n   Type: ScaledIdentity (1)\n   Coefnames: [\"formulation: 1\", \"formulation: 2\"]\nRepeated:\n   Model: formulation\n   Type: VarianceComponents (2)\n   Coefnames: [\"formulation: 1\", \"formulation: 2\"]\n\nStatus: converged\n\n   -2 logREML: 16.0615\n\n   Fixed effects:\n\nName             Estimate     SE\n(Intercept)      1.57212      0.305807\nsequence: 2      -0.170833    0.279555\nperiod: 2        0.204087     0.289957\nperiod: 3        0.155769     0.11308\nperiod: 4        0.160015     0.289957\nformulation: 2   -0.0791667   0.279555\n\nRandom effects:\n\n   θ vector: [0.412436, 0.145184, 0.220819]\n\nRandom 1   Var              var   0.170103\nRepeated   formulation: 1   var   0.0210784\nRepeated   formulation: 2   var   0.048761\n=#\n\n#EXAMPLE 3\n################################################################################\n################################################################################\n################################################################################\n#=\nPROC MIXED data=df0;\nCLASSES subject sequence period formulation;\nMODEL  var = sequence period formulation/ DDFM=SATTERTH s;\nRANDOM  subject/TYPE=VC G V;\nRUN;\n\nREML: 10.86212458\n=#\n\nlmm = LMM(@formula(var ~ sequence + period + formulation), df;\n    random = VarEffect(@covstr(subject), SI)\n    )\nfit!(lmm)\n#=\nLinear Mixed Model: var ~ sequence + period + formulation\nRandom 1:\n   Model: subject\n   Type: ScaledIdentity (1)\n   Coefnames: [\"subject: 1\", \"subject: 2\", \"subject: 3\", \"subject: 4\", \"subject: 5\"]\nRepeated:\n   Model: nothing\n   Type: ScaledIdentity (1)\n   Coefnames: -\n\nStatus: converged\n\n   -2 logREML: 10.8621\n\n   Fixed effects:\n\nName             Estimate     SE\n(Intercept)      1.61         0.309774\nsequence: 2      -0.170833    0.383959\nperiod: 2        0.144167     0.116706\nperiod: 3        0.08         0.115509\nperiod: 4        0.144167     0.116706\nformulation: 2   -0.0791667   0.0833617\n\nRandom effects:\n\n   θ vector: [0.410574, 0.182636]\n\nRandom 1   Var   var   0.168571\nRepeated   Var   var   0.0333559\n=#\n\n#EXAMPLE 4\n################################################################################\n################################################################################\n################################################################################\n#=\nPROC MIXED data=df0;\nCLASSES subject sequence period formulation;\nMODEL  var = sequence period formulation/ DDFM=SATTERTH s;\nRANDOM  period/TYPE=VC G V;\nRANDOM  formulation/TYPE=VC G V;\nRUN;\n\nREML: 25.12948063\n=#\nlmm = LMM(\n    @formula(var ~ sequence + period + formulation), df;\n    random   = [VarEffect(@covstr(period), VC), VarEffect(@covstr(formulation), VC)]\n)\nfit!(lmm)\n\n#=\nLinear Mixed Model: var ~ sequence + period + formulation\nRandom 1:\n   Model: period\n   Type: VarianceComponents (4)\n   Coefnames: [\"period: 1\", \"period: 2\", \"period: 3\", \"period: 4\"]\nRandom 2:\n   Model: formulation\n   Type: VarianceComponents (2)\n   Coefnames: [\"formulation: 1\", \"formulation: 2\"]\nRepeated:\n   Model: nothing\n   Type: ScaledIdentity (1)\n   Coefnames: -\n\nStatus: converged\n\n   -2 logREML: 25.1295\n\n   Fixed effects:\n\nName             Estimate     SE\n(Intercept)      1.61         0.249491\nsequence: 2      -0.170833    0.192487\nperiod: 2        0.144167     0.269481\nperiod: 3        0.08         0.266717\nperiod: 4        0.144167     0.269481\nformulation: 2   -0.0791667   0.192487\n\nRandom effects:\n\n   θ vector: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.421717]\n\nRandom 1   period: 1        var   0.0\nRandom 1   period: 2        var   0.0\nRandom 1   period: 3        var   0.0\nRandom 1   period: 4        var   0.0\nRandom 2   formulation: 1   var   0.0\nRandom 2   formulation: 2   var   0.0\nRepeated   Var              var   0.177845\n=#\n\n#EXAMPLE 5\n################################################################################\n################################################################################\n################################################################################\n#=\nPROC MIXED data=df0;\nCLASSES subject sequence period formulation;\nMODEL  var = sequence period formulation/ DDFM=SATTERTH s;\nRANDOM  formulation/TYPE=UN(1) SUB=subject G V;\nRUN;\n\nREML: 16.24111264\n=#\n\nlmm = LMM(@formula(var ~ sequence + period + formulation), df;\n    random  = VarEffect(@covstr(formulation), VC),\n    subject = :subject)\nfit!(lmm)\n\n#=\nLinear Mixed Model: var ~ sequence + period + formulation\nRandom 1:\n   Model: formulation\n   Type: VarianceComponents (2)\n   Coefnames: [\"formulation: 1\", \"formulation: 2\"]\nRepeated:\n   Model: nothing\n   Type: ScaledIdentity (1)\n   Coefnames: -\n\nStatus: converged\n\n   -2 logREML: 16.2411\n\n   Fixed effects:\n\nName             Estimate     SE\n(Intercept)      1.61         0.334718\nsequence: 2      -0.170833    0.277378\nperiod: 2        0.144167     0.289463\nperiod: 3        0.08         0.117047\nperiod: 4        0.144167     0.289463\nformulation: 2   -0.0791667   0.277378\n\nRandom effects:\n\n   θ vector: [0.447322, 0.367367, 0.185068]\n\nRandom 1   formulation: 1   var   0.200097\nRandom 1   formulation: 2   var   0.134959\nRepeated   Var              var   0.0342502\n=#\n\n#EXAMPLE 6\n################################################################################\n################################################################################\n################################################################################\n\nusing MixedModels\n\nfm = @formula(var~sequence+period+formulation + (0+formulation|subject))\nmm = fit(MixedModel, fm, df, REML=true)\n\n#=\nLinear mixed model fit by REML\n var ~ 1 + sequence + period + formulation + (0 + formulation | subject)\n REML criterion at convergence: 10.314822479361407\n\nVariance components:\n             Column      Variance Std.Dev.   Corr.\nsubject  formulation: 1  0.2027892 0.450321\n         formulation: 2  0.1383032 0.371891 +1.00\nResidual                 0.0316615 0.177937\n Number of obs: 20; levels of grouping factors: 5\n\n  Fixed-effects parameters:\n───────────────────────────────────────────────────────\n                     Coef.  Std. Error      z  Pr(>|z|)\n───────────────────────────────────────────────────────\n(Intercept)      1.61        0.335375    4.80    <1e-5\nsequence: 2     -0.170833    0.383975   -0.44    0.6564\nperiod: 2        0.144167    0.119206    1.21    0.2265\nperiod: 3        0.08        0.112537    0.71    0.4772\nperiod: 4        0.144167    0.119206    1.21    0.2265\nformulation: 2  -0.0791667   0.0887562  -0.89    0.3724\n───────────────────────────────────────────────────────\n=#\n\nlmm = LMM(@formula(var~sequence+period+formulation), df;\nrandom = VarEffect(Metida.@covstr(formulation), CSH),\nrepeated = VarEffect(Metida.@covstr(formulation), SI),\nsubject = :subject)\nMetida.fit!(lmm)\n\n#=\nLinear Mixed Model: var ~ sequence + period + formulation\nRandom 1:\n   Model: formulation\n   Type: CSH (3)\n   Coefnames: [\"formulation: 1\", \"formulation: 2\"]\nRepeated:\n   Model: formulation\n   Type: SI (1)\n   Coefnames: [\"formulation: 1\", \"formulation: 2\"]\n\nStatus: converged\n\n   -2 logREML: 10.3148\n\n   Fixed effects:\n\nName             Estimate     SE          z           Pr(>|z|)\n(Intercept)      1.61         0.335376    4.80058     1.58204e-6\nsequence: 2      -0.170833    0.383976    -0.444906   0.656388\nperiod: 2        0.144167     0.119205    1.2094      0.226511\nperiod: 3        0.08         0.112537    0.710877    0.47716\nperiod: 4        0.144167     0.119205    1.2094      0.226511\nformulation: 2   -0.0791667   0.0887561   -0.891957   0.372416\n\nRandom effects:\n\n   θ vector: [0.450323, 0.371893, 1.0, 0.177937]\n\nRandom 1   formulation: 1   var   0.202791\nRandom 1   formulation: 2   var   0.138304\nRandom 1   Rho              rho   1.0\nRepeated   Var              var   0.0316616\n=#\n\n################################################################################\n","category":"page"},{"location":"#Metida","page":"Home","title":"Metida","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"CurrentModule = Metida","category":"page"},{"location":"#Mixed-Models","page":"Home","title":"Mixed Models","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Metida.jl is a Julia package for fitting mixed-effects models with flexible covariance structure. At this moment package is in early development stage.","category":"page"},{"location":"","page":"Home","title":"Home","text":"Main goal to make reproducible output corresponding to SAS/SPSS.","category":"page"},{"location":"","page":"Home","title":"Home","text":"Now implemented covariance structures:","category":"page"},{"location":"","page":"Home","title":"Home","text":"Scaled Identity (SI)\nVariance Components / Diagonal (VC)\nAutoregressive (AR)\nHeterogeneous Autoregressive (ARH)\nCompound Symmetry (CS)\nHeterogeneous Compound Symmetry (CSH)","category":"page"},{"location":"","page":"Home","title":"Home","text":"Usage:","category":"page"},{"location":"","page":"Home","title":"Home","text":"LMM(model, data; subject = nothing,  random = nothing, repeated = nothing)","category":"page"},{"location":"","page":"Home","title":"Home","text":"where","category":"page"},{"location":"","page":"Home","title":"Home","text":"model is a fixed-effect model (@formula), example: @formula(var ~ sequence + period + formulation)","category":"page"},{"location":"","page":"Home","title":"Home","text":"random vector of random effects or single random effect. Effect can be declared like this: VarEffect(@covstr(formulation), CSH). @covstr is a effect model: @covstr(formulation). CSH is a  CovarianceType structure. Premade constants: SI, VC, AR, ARH, CSH.","category":"page"},{"location":"","page":"Home","title":"Home","text":"repeated is a repeated effect (only single).","category":"page"},{"location":"","page":"Home","title":"Home","text":"subject is a block-diagonal factor.","category":"page"},{"location":"","page":"Home","title":"Home","text":"Pages = [\n        \"examples.md\",\n        \"details.md\",\n        \"api.md\"]\nDepth = 3","category":"page"},{"location":"","page":"Home","title":"Home","text":"See also:","category":"page"},{"location":"","page":"Home","title":"Home","text":"https://github.com/JuliaStats/MixedModels.jl","category":"page"}]
}
